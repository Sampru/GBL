<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>ALU: src/descfb.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ALU
   &#160;<span id="projectnumber">5.1</span>
   </div>
   <div id="projectbrief">ALMIS_utilities</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('descfb_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">descfb.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Data Encryption Standard: 64-bit cipher-feedback mode encryption/decryption.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdarg.h&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="descfb_8h_source.html">descfb.h</a>&gt;</code><br/>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdes_key_type.html">desKeyType</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_key_item.html">KeyItem</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdes_pair.html">desPair</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">union &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="uniondes_union.html">desUnion</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ad15d5088fd3c010fe95207f08d556e44"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#ad15d5088fd3c010fe95207f08d556e44">BLOCKBITS</a>&#160;&#160;&#160;64  /* bits per <a class="el" href="descfb_8c.html#a46ea2ff48539c20e17d7bf23c62c5c9d">block</a> */</td></tr>
<tr class="separator:ad15d5088fd3c010fe95207f08d556e44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41ee6b3bbf473cd4170062630e76d85c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#a41ee6b3bbf473cd4170062630e76d85c">KEYBITS</a>&#160;&#160;&#160;56  /* bits per key */</td></tr>
<tr class="separator:a41ee6b3bbf473cd4170062630e76d85c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6775b2ea5f0124e1d9ec2578bb912ba"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#ad6775b2ea5f0124e1d9ec2578bb912ba">STAGECOUNT</a>&#160;&#160;&#160;16  /* number of stages */</td></tr>
<tr class="separator:ad6775b2ea5f0124e1d9ec2578bb912ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f9068dc2e35cb56ec640a7f4e41af98"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#a4f9068dc2e35cb56ec640a7f4e41af98">DES_BLOCKSIZE</a>&#160;&#160;&#160;8  /* bytes per <a class="el" href="descfb_8c.html#a46ea2ff48539c20e17d7bf23c62c5c9d">block</a> */</td></tr>
<tr class="separator:a4f9068dc2e35cb56ec640a7f4e41af98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79bcfb6bde984f42d1124b068a509af7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#a79bcfb6bde984f42d1124b068a509af7">BASE</a>&#160;&#160;&#160;1  /* a kludge for 0 vs 1 arrays */</td></tr>
<tr class="separator:a79bcfb6bde984f42d1124b068a509af7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:afa35a41db9e9b238ecebeaaf132260b9"><td class="memItemLeft" align="right" valign="top">typedef unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#afa35a41db9e9b238ecebeaaf132260b9">bitIndexVector</a> []</td></tr>
<tr class="separator:afa35a41db9e9b238ecebeaaf132260b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46ea2ff48539c20e17d7bf23c62c5c9d"><td class="memItemLeft" align="right" valign="top">typedef char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#a46ea2ff48539c20e17d7bf23c62c5c9d">block</a> [<a class="el" href="descfb_8c.html#a4f9068dc2e35cb56ec640a7f4e41af98">DES_BLOCKSIZE</a>]</td></tr>
<tr class="separator:a46ea2ff48539c20e17d7bf23c62c5c9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6103fa3c0f6178a25e190888434e990d"><td class="memItemLeft" align="right" valign="top">static unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#a6103fa3c0f6178a25e190888434e990d">lcDEScfbDesStr</a> (register char *Dst, register char *Src, register unsigned Siz, int <a class="el" href="_dap_rea_8c.html#ac83ce815bc02fe100e90ee35c11de9b1">NbKey</a>, va_list VarKey)</td></tr>
<tr class="memdesc:a6103fa3c0f6178a25e190888434e990d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encipher/decipher a block of memory using cipher-feedback mode.  <a href="#a6103fa3c0f6178a25e190888434e990d"></a><br/></td></tr>
<tr class="separator:a6103fa3c0f6178a25e190888434e990d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81fbb1392f4c4da5e71b3e2bbcae74dc"><td class="memItemLeft" align="right" valign="top">static unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#a81fbb1392f4c4da5e71b3e2bbcae74dc">lcDEScfbDesStrOneKey</a> (register char *Dst, register char *Src, register unsigned Siz, int CntKey)</td></tr>
<tr class="memdesc:a81fbb1392f4c4da5e71b3e2bbcae74dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encipher/decipher a block of memory using cipher-feedback mode.  <a href="#a81fbb1392f4c4da5e71b3e2bbcae74dc"></a><br/></td></tr>
<tr class="separator:a81fbb1392f4c4da5e71b3e2bbcae74dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22117697f36ffed2343f4b6f513d6325"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#a22117697f36ffed2343f4b6f513d6325">lcDESxor</a> (register char *Dst, register char *Src, register char *Xor, register unsigned Cnt)</td></tr>
<tr class="memdesc:a22117697f36ffed2343f4b6f513d6325"><td class="mdescLeft">&#160;</td><td class="mdescRight">Do an xor between two strings.  <a href="#a22117697f36ffed2343f4b6f513d6325"></a><br/></td></tr>
<tr class="separator:a22117697f36ffed2343f4b6f513d6325"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a001d2b0b82d4f030de98b46f55b7c721"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#a001d2b0b82d4f030de98b46f55b7c721">lcDEScfbDes</a> (unsigned char *Dst, unsigned char *Src, <a class="el" href="structdes_key_type.html">desKeyType</a> *Key)</td></tr>
<tr class="memdesc:a001d2b0b82d4f030de98b46f55b7c721"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypt/decrypt a string using a key.  <a href="#a001d2b0b82d4f030de98b46f55b7c721"></a><br/></td></tr>
<tr class="separator:a001d2b0b82d4f030de98b46f55b7c721"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecc15c11129b021efda00415b171602c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#aecc15c11129b021efda00415b171602c">lcDESpckBlk</a> (<a class="el" href="structdes_pair.html">desPair</a> *Dst, unsigned char *Src)</td></tr>
<tr class="memdesc:aecc15c11129b021efda00415b171602c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a string of bytes to a <a class="el" href="structdes_pair.html">desPair</a>.  <a href="#aecc15c11129b021efda00415b171602c"></a><br/></td></tr>
<tr class="separator:aecc15c11129b021efda00415b171602c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4648644c91ed9821c2b6d2b73e2e03e2"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#a4648644c91ed9821c2b6d2b73e2e03e2">lcDESunpckBlk</a> (unsigned char *Dst, <a class="el" href="structdes_pair.html">desPair</a> *Src)</td></tr>
<tr class="memdesc:a4648644c91ed9821c2b6d2b73e2e03e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a <a class="el" href="structdes_pair.html">desPair</a> to a string of bytes.  <a href="#a4648644c91ed9821c2b6d2b73e2e03e2"></a><br/></td></tr>
<tr class="separator:a4648644c91ed9821c2b6d2b73e2e03e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeed50ea4b4145ede90e9abfaac5746cf"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#aeed50ea4b4145ede90e9abfaac5746cf">lcDESip</a> (<a class="el" href="structdes_pair.html">desPair</a> *Dst, <a class="el" href="structdes_pair.html">desPair</a> *Src)</td></tr>
<tr class="memdesc:aeed50ea4b4145ede90e9abfaac5746cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">IP.  <a href="#aeed50ea4b4145ede90e9abfaac5746cf"></a><br/></td></tr>
<tr class="separator:aeed50ea4b4145ede90e9abfaac5746cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae755cfa759ec9681276c2aceeea2c398"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#ae755cfa759ec9681276c2aceeea2c398">lcDESipInv</a> (<a class="el" href="structdes_pair.html">desPair</a> *Dst, register unsigned long Lft, register unsigned long Rgt)</td></tr>
<tr class="memdesc:ae755cfa759ec9681276c2aceeea2c398"><td class="mdescLeft">&#160;</td><td class="mdescRight">IP inverse.  <a href="#ae755cfa759ec9681276c2aceeea2c398"></a><br/></td></tr>
<tr class="separator:ae755cfa759ec9681276c2aceeea2c398"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad09e228de5ba8f344b68fe2f4d57429"><td class="memItemLeft" align="right" valign="top">static unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#aad09e228de5ba8f344b68fe2f4d57429">lcDESfunDes</a> (unsigned long Inp, unsigned char *Key)</td></tr>
<tr class="memdesc:aad09e228de5ba8f344b68fe2f4d57429"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encryptation/Desencryptation function.  <a href="#aad09e228de5ba8f344b68fe2f4d57429"></a><br/></td></tr>
<tr class="separator:aad09e228de5ba8f344b68fe2f4d57429"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8caebf712703ad6d7809349d26feb1d4"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#a8caebf712703ad6d7809349d26feb1d4">lcDESmakKey</a> (<a class="el" href="structdes_key_type.html">desKeyType</a> **key, unsigned char *KeyBit, unsigned KeySiz, int Typ)</td></tr>
<tr class="memdesc:a8caebf712703ad6d7809349d26feb1d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given a key string, produce a key suitable for encryption, decryption.  <a href="#a8caebf712703ad6d7809349d26feb1d4"></a><br/></td></tr>
<tr class="separator:a8caebf712703ad6d7809349d26feb1d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a613422c3d505b23209128af9c66b7b2d"><td class="memItemLeft" align="right" valign="top">static unsigned char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#a613422c3d505b23209128af9c66b7b2d">lcDESunpckKeyBlk</a> (register unsigned char *Dst, register unsigned char *Src)</td></tr>
<tr class="memdesc:a613422c3d505b23209128af9c66b7b2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a key block to a bit vector.  <a href="#a613422c3d505b23209128af9c66b7b2d"></a><br/></td></tr>
<tr class="separator:a613422c3d505b23209128af9c66b7b2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7ecd541d36876822878e43c3b22d225"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#af7ecd541d36876822878e43c3b22d225">lcDEStps</a> (unsigned char *Src, unsigned char *Dst, unsigned char DstSiz, unsigned char SrcSiz, <a class="el" href="descfb_8c.html#afa35a41db9e9b238ecebeaaf132260b9">bitIndexVector</a> Pmt)</td></tr>
<tr class="memdesc:af7ecd541d36876822878e43c3b22d225"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transpose a key.  <a href="#af7ecd541d36876822878e43c3b22d225"></a><br/></td></tr>
<tr class="separator:af7ecd541d36876822878e43c3b22d225"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3fb25a676cd6c1ff7caf6dbb72733f3"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#af3fb25a676cd6c1ff7caf6dbb72733f3">lcDESrotLft</a> (unsigned char *Ptr, unsigned char Siz)</td></tr>
<tr class="memdesc:af3fb25a676cd6c1ff7caf6dbb72733f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate to the left.  <a href="#af3fb25a676cd6c1ff7caf6dbb72733f3"></a><br/></td></tr>
<tr class="separator:af3fb25a676cd6c1ff7caf6dbb72733f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a3c7b3caee660fa2d99eb65727b0510"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#a3a3c7b3caee660fa2d99eb65727b0510">lcDESkeyToTps</a> (register unsigned char *Dst, register unsigned char *Src)</td></tr>
<tr class="separator:a3a3c7b3caee660fa2d99eb65727b0510"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5d52c6f44eee953aa695257238b5ba8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#ab5d52c6f44eee953aa695257238b5ba8">lcDESasc2key</a> (unsigned char *KeyBit, char *KeyAsc, int Pad)</td></tr>
<tr class="memdesc:ab5d52c6f44eee953aa695257238b5ba8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert an ASCII string of arbitrary length to an 8-byte key.  <a href="#ab5d52c6f44eee953aa695257238b5ba8"></a><br/></td></tr>
<tr class="separator:ab5d52c6f44eee953aa695257238b5ba8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9ff8e35a0d73f656f4ebec70c9cc8f9"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#ac9ff8e35a0d73f656f4ebec70c9cc8f9">lcDESsetKeyBit</a> (register unsigned char *Dst, register char *Src, register unsigned KeySiz)</td></tr>
<tr class="memdesc:ac9ff8e35a0d73f656f4ebec70c9cc8f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shift each byte in a block of memory left by one bit.  <a href="#ac9ff8e35a0d73f656f4ebec70c9cc8f9"></a><br/></td></tr>
<tr class="separator:ac9ff8e35a0d73f656f4ebec70c9cc8f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d0c8391dc5b25b665c5c4e9032f46d4"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#a8d0c8391dc5b25b665c5c4e9032f46d4">lcDESstrMAC</a> (register char *Mac, register char *KeyStr, register unsigned KeyStrSiz, char Pad, void *key)</td></tr>
<tr class="memdesc:a8d0c8391dc5b25b665c5c4e9032f46d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute a Message Authentication code.  <a href="#a8d0c8391dc5b25b665c5c4e9032f46d4"></a><br/></td></tr>
<tr class="separator:a8d0c8391dc5b25b665c5c4e9032f46d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b84e498a23c494faf1e3e43f23a789b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#a0b84e498a23c494faf1e3e43f23a789b">lcDESsetKey</a> (register <a class="el" href="structdes_key_type.html">desKeyType</a> **KeyOut, unsigned char *KeyBit, char *KeyStr, int Typ)</td></tr>
<tr class="memdesc:a0b84e498a23c494faf1e3e43f23a789b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypt the key.  <a href="#a0b84e498a23c494faf1e3e43f23a789b"></a><br/></td></tr>
<tr class="separator:a0b84e498a23c494faf1e3e43f23a789b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb94bc4c3b3c82931f1c1c5a7d5d2211"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#afb94bc4c3b3c82931f1c1c5a7d5d2211">lcDESisWeaKey</a> (char *KeyBit, int *IsWea)</td></tr>
<tr class="memdesc:afb94bc4c3b3c82931f1c1c5a7d5d2211"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return nonzero if the key is one of the well-known "weak" keys (FIPS Pub 74)  <a href="#afb94bc4c3b3c82931f1c1c5a7d5d2211"></a><br/></td></tr>
<tr class="separator:afb94bc4c3b3c82931f1c1c5a7d5d2211"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27daabfde4f3a067ed09dcfa878acd7a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#a27daabfde4f3a067ed09dcfa878acd7a">lcDESforKey</a> (register char *Dst, register char *Src, register unsigned Siz, int <a class="el" href="_dap_rea_8c.html#ac83ce815bc02fe100e90ee35c11de9b1">NbKey</a>)</td></tr>
<tr class="memdesc:a27daabfde4f3a067ed09dcfa878acd7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypt/decrypt for each key.  <a href="#a27daabfde4f3a067ed09dcfa878acd7a"></a><br/></td></tr>
<tr class="separator:a27daabfde4f3a067ed09dcfa878acd7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acedba6bcb12dc7f8bad4999bd5a8c7ad"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#acedba6bcb12dc7f8bad4999bd5a8c7ad">DEScfbDesStr</a> (register char *Dst, register char *Src, register unsigned Siz, int <a class="el" href="_dap_rea_8c.html#ac83ce815bc02fe100e90ee35c11de9b1">NbKey</a>,...)</td></tr>
<tr class="memdesc:acedba6bcb12dc7f8bad4999bd5a8c7ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encipher/decipher a block of memory using cipher-feedback mode.  <a href="#acedba6bcb12dc7f8bad4999bd5a8c7ad"></a><br/></td></tr>
<tr class="separator:acedba6bcb12dc7f8bad4999bd5a8c7ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64950342c5305fe4b4fec5d72d68a90e"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#a64950342c5305fe4b4fec5d72d68a90e">DEScfbDesFil</a> (char *FilSrc, char *FilDst, int <a class="el" href="_dap_rea_8c.html#ac83ce815bc02fe100e90ee35c11de9b1">NbKey</a>,...)</td></tr>
<tr class="memdesc:a64950342c5305fe4b4fec5d72d68a90e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encipher/decipher a file.  <a href="#a64950342c5305fe4b4fec5d72d68a90e"></a><br/></td></tr>
<tr class="separator:a64950342c5305fe4b4fec5d72d68a90e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5d56018d0347a687fdd257fa7a4c560"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#ab5d56018d0347a687fdd257fa7a4c560">DEScrtStrModKey</a> (register char *Dst, register char *Src, register unsigned Siz, int EncTyp, int <a class="el" href="_dap_rea_8c.html#ac83ce815bc02fe100e90ee35c11de9b1">NbKey</a>, char **VarKey)</td></tr>
<tr class="memdesc:ab5d56018d0347a687fdd257fa7a4c560"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encipher/decipher a string pending Mode type and keys.  <a href="#ab5d56018d0347a687fdd257fa7a4c560"></a><br/></td></tr>
<tr class="separator:ab5d56018d0347a687fdd257fa7a4c560"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ac5aec3492ecce29e42b1b66aac06a6d6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_key_item.html">KeyItem</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#ac5aec3492ecce29e42b1b66aac06a6d6">DesKey</a> [<a class="el" href="descfb_8h.html#a49d1b2ad1b5585be5bdc77ae25720f61">MAXCIPHER</a>]</td></tr>
<tr class="separator:ac5aec3492ecce29e42b1b66aac06a6d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e9f5948a220de9cb6dc6998b28778e4"><td class="memItemLeft" align="right" valign="top">char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#a2e9f5948a220de9cb6dc6998b28778e4">IvcBit</a> [] = { 0x12, 0x34, 0x56, 0x78, 0x90, 0xab, 0xcd, 0xef }</td></tr>
<tr class="separator:a2e9f5948a220de9cb6dc6998b28778e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeceacc57b7037fe50fa7ca1dadeaca79"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#aeceacc57b7037fe50fa7ca1dadeaca79">keyRotates</a> [<a class="el" href="descfb_8c.html#ad6775b2ea5f0124e1d9ec2578bb912ba">STAGECOUNT</a>]</td></tr>
<tr class="separator:aeceacc57b7037fe50fa7ca1dadeaca79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e532b0a9035c6fc02af5dcb8b901fb3"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#a0e532b0a9035c6fc02af5dcb8b901fb3">keyTr1</a> [<a class="el" href="descfb_8c.html#a41ee6b3bbf473cd4170062630e76d85c">KEYBITS</a>]</td></tr>
<tr class="separator:a0e532b0a9035c6fc02af5dcb8b901fb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6e3159251b64b005d6301296dfa7700"><td class="memItemLeft" align="right" valign="top"><a class="el" href="descfb_8c.html#a46ea2ff48539c20e17d7bf23c62c5c9d">block</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#ab6e3159251b64b005d6301296dfa7700">BadKey</a> [16]</td></tr>
<tr class="separator:ab6e3159251b64b005d6301296dfa7700"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20a1620b02f81fa8d58defea52ef82eb"><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="descfb_8c.html#a20a1620b02f81fa8d58defea52ef82eb">sBoxp</a> [8][64]</td></tr>
<tr class="separator:a20a1620b02f81fa8d58defea52ef82eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Data Encryption Standard: 64-bit cipher-feedback mode encryption/decryption. </p>
<p>Data Encryption Standard: 64-bit cipher-feedback mode encryption/decryption</p>
<ul>
<li>Note: destination and source may overlap for encryption but not decryption</li>
</ul>
<ul>
<li>To create a message authentication code (MAC):</li>
<li>The returned initialization vector from the final call to either CFB routine should be passed to the DES function. The leftmost (most significant) n-bits may be used as the MAC. Deciphering the ciphertext will produce the same MAC as enciphering the plaintext. This is the method used in FIPS Pub 81, with 64-bit CFB (cipher feedback) mode, with the last block shifted in by the number of bits it contains.</li>
</ul>
<ul>
<li>If compatability with FIPS Publication 113 is desired, the input data should be padded with zeros until it is a multiple of 8 bytes. Then, the initialization vector should be set to the first eight bytes of the input data, and the remaining bytes enciphered (or ciphertext deciphered). Then use the final initialization vector as above.</li>
</ul>
<ul>
<li>Written by: David A. Barrett (barrettasgard@boulder.Colorado.EDU)</li>
</ul>
<dl class="section user"><dt>Header file</dt><dd><a class="el" href="descfb_8h.html" title="DES encryption/decryption file.">descfb.h</a></dd></dl>
<dl class="section user"><dt>Acronyme</dt><dd>DES</dd></dl>
<dl class="section user"><dt>Library</dt><dd>cross</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jon BARRUTIA - 02/Jul/2002 </dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a79bcfb6bde984f42d1124b068a509af7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BASE&#160;&#160;&#160;1  /* a kludge for 0 vs 1 arrays */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ad15d5088fd3c010fe95207f08d556e44"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BLOCKBITS&#160;&#160;&#160;64  /* bits per <a class="el" href="descfb_8c.html#a46ea2ff48539c20e17d7bf23c62c5c9d">block</a> */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a4f9068dc2e35cb56ec640a7f4e41af98"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DES_BLOCKSIZE&#160;&#160;&#160;8  /* bytes per <a class="el" href="descfb_8c.html#a46ea2ff48539c20e17d7bf23c62c5c9d">block</a> */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a41ee6b3bbf473cd4170062630e76d85c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEYBITS&#160;&#160;&#160;56  /* bits per key */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ad6775b2ea5f0124e1d9ec2578bb912ba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STAGECOUNT&#160;&#160;&#160;16  /* number of stages */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="afa35a41db9e9b238ecebeaaf132260b9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef unsigned char bitIndexVector[]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a46ea2ff48539c20e17d7bf23c62c5c9d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef char block[<a class="el" href="descfb_8c.html#a4f9068dc2e35cb56ec640a7f4e41af98">DES_BLOCKSIZE</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a64950342c5305fe4b4fec5d72d68a90e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned DEScfbDesFil </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>FilSrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>FilDst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>NbKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encipher/decipher a file. </p>
<p>Encipher/decipher a file</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">FilSrc</td><td>Source address </td></tr>
    <tr><td class="paramname">FilDst</td><td>Destination address </td></tr>
    <tr><td class="paramname">NbKey</td><td>Number of keys used to encipher/decipher. The maximum number of keys is 10 </td></tr>
    <tr><td class="paramname">...</td><td>NbKey groups of (Typ, Key)<ul>
<li>Typ: Non-zero for decryption, zero for encryption</li>
<li>Key in ASCII format</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)<ul>
<li>1: Can not open source file</li>
<li>2: Can not open destination file</li>
<li>3: Weak key selected</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jon BARRUTIA - 02/Jul/2002</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Jon BARRUTIA - 11/Sep/2002. Open the source and destination files in binary mode</li>
<li>Jon BARRUTIA - 12/Sep/2002. Added a encipher/decipher type for each key</li>
<li>Edurne GORDOA - 27/Feb/2014: Print internal errors when files cannot be opened. Close source file when there is a problem opening destination file </li>
</ul>

</div>
</div>
<a class="anchor" id="acedba6bcb12dc7f8bad4999bd5a8c7ad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned DEScfbDesStr </td>
          <td>(</td>
          <td class="paramtype">register char *&#160;</td>
          <td class="paramname"><em>Dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">register char *&#160;</td>
          <td class="paramname"><em>Src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">register unsigned&#160;</td>
          <td class="paramname"><em>Siz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>NbKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encipher/decipher a block of memory using cipher-feedback mode. </p>
<p>Encipher/decipher a block of memory using cipher-feedback mode</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Dst</td><td>Destination address </td></tr>
    <tr><td class="paramname">Src</td><td>Source address </td></tr>
    <tr><td class="paramname">Siz</td><td>Destination and source size in bytes </td></tr>
    <tr><td class="paramname">NbKey</td><td>Number of keys used to encipher/decipher. The maximum number of keys is 10 </td></tr>
    <tr><td class="paramname">...</td><td>NbKey groups of (Typ, Key)<ul>
<li>Typ: Non-zero for decryption, zero for encryption</li>
<li>Key in ASCII format</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jon BARRUTIA - 02/Jul/2002</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Jon BARRUTIA - 12/Sep/2002. Added a encipher/decipher type for each key </li>
</ul>

</div>
</div>
<a class="anchor" id="ab5d56018d0347a687fdd257fa7a4c560"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DEScrtStrModKey </td>
          <td>(</td>
          <td class="paramtype">register char *&#160;</td>
          <td class="paramname"><em>Dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">register char *&#160;</td>
          <td class="paramname"><em>Src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">register unsigned&#160;</td>
          <td class="paramname"><em>Siz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>EncTyp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>NbKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>VarKey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encipher/decipher a string pending Mode type and keys. </p>
<p>Encipher/decipher a block of memory using cipher-feedback mode. Pending Mode type and keys is automatically generated an (Typ, Key) group. If mode value is Encrypt (1) generated array that the Typ and Key order is the same order of the key parameters starting Type with 0. Otherwise, if mode is Desencrypt (0), keys order in the array has been inverted, and Typ parameter start with 1. Mod = 1 &ndash;&gt; {{0, Key1}, {1, Key2}, {0, Key3}, {1, Key4},..., {x,Keylast}} Mod = 0 &ndash;&gt; {{-x, Keylast}, ..., {1, Key3}, {0, Key2}, {1, Key1}}</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Dst</td><td>Destination address </td></tr>
    <tr><td class="paramname">Src</td><td>Source address </td></tr>
    <tr><td class="paramname">Siz</td><td>Destination and source size in bytes </td></tr>
    <tr><td class="paramname">EncTyp</td><td>encript type 1: Encrypt, 0: Desencrypt </td></tr>
    <tr><td class="paramname">NbKey</td><td>Number of keys used to encipher/decipher </td></tr>
    <tr><td class="paramname">VarKey</td><td>Keys in ASCII format</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Nerea RAMOS - 25/Oct/2002</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Nerea RAMOS - 11/Mar/2003. Correct EncTyp parameter description </li>
</ul>

</div>
</div>
<a class="anchor" id="ab5d52c6f44eee953aa695257238b5ba8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void lcDESasc2key </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>KeyBit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>KeyAsc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Pad</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Convert an ASCII string of arbitrary length to an 8-byte key. </p>
<p>Convert an ASCII string of arbitrary length to an 8-byte key suitable as an input key for the DES.</p>
<ul>
<li>The string is padded on the right with &lt;pad&gt; to a multiple of 8 characters. The minimim length of the resulting string will be 16 characters.</li>
<li>A key is computed by using the first 8 characters of the string, each character left-shifted by one bit. This key is used to encipher the remaining characters of the string using the DES in CFB (cipher feed-back) mode, IV = 0, to compute a Message Authentication Code ala FIPS PUB 113.</li>
</ul>
<ul>
<li>For input strings of 8 or fewer characters, this will result in the DES encryption of the string consisting of 8 &lt;pad&gt; characters. FIPS Pub 112 used the space character for &lt;pad&gt;.</li>
</ul>
<ul>
<li>NOTE: Unlike fips Pub 112, this algorithm does not restrict the output bits to be an 8 character string consisting of the printable ASCII characters. The string is returned as 8 chararcters of 8-bits each. No parity is computed.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">KeyBit</td><td>(out). 8-byte key </td></tr>
    <tr><td class="paramname">KeyAsc</td><td>ASCII string </td></tr>
    <tr><td class="paramname">Pad</td><td>Character to pad the string</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jon BARRUTIA - 02/Jul/2002</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<p>&ndash; Amparo CAMARERO - 23/Oct/2012: Correct function header to match new DOXYGEN format</p>
<ul>
<li>Egoitz GARAY - 12/Jan/2015: Disabled Visual Studio warning 4244 and 4267 with a compiler pragma. </li>
</ul>

</div>
</div>
<a class="anchor" id="a001d2b0b82d4f030de98b46f55b7c721"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void lcDEScfbDes </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>Dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>Src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdes_key_type.html">desKeyType</a> *&#160;</td>
          <td class="paramname"><em>Key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Encrypt/decrypt a string using a key. </p>
<p>Encrypt/decrypt a string using a key</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Dst</td><td>Destination address </td></tr>
    <tr><td class="paramname">Src</td><td>Source address </td></tr>
    <tr><td class="paramname">Key</td><td>Used key for the Encryption/decryption</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jon BARRUTIA - 02/Jul/2002 </dd></dl>

</div>
</div>
<a class="anchor" id="a6103fa3c0f6178a25e190888434e990d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static unsigned lcDEScfbDesStr </td>
          <td>(</td>
          <td class="paramtype">register char *&#160;</td>
          <td class="paramname"><em>Dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">register char *&#160;</td>
          <td class="paramname"><em>Src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">register unsigned&#160;</td>
          <td class="paramname"><em>Siz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>NbKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">va_list&#160;</td>
          <td class="paramname"><em>VarKey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Encipher/decipher a block of memory using cipher-feedback mode. </p>
<p>Encipher/decipher a block of memory using cipher-feedback mode</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Dst</td><td>Destination address </td></tr>
    <tr><td class="paramname">Src</td><td>Source address </td></tr>
    <tr><td class="paramname">Siz</td><td>Destination and source size in bytes </td></tr>
    <tr><td class="paramname">NbKey</td><td>Number of keys used to encipher/decipher </td></tr>
    <tr><td class="paramname">VarKey</td><td>NbKey groups of (Typ, Key)<ul>
<li>Typ: Non-zero for decryption, zero for encryption</li>
<li>Key in ASCII format</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jon BARRUTIA - 02/Jul/2002</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Jon BARRUTIA - 12/Sep/2002. Added a encipher/decipher type for each key</li>
<li>Nerea RAMOS - 28/Oct/2002. Call to lcDESforKey </li>
</ul>

</div>
</div>
<a class="anchor" id="a81fbb1392f4c4da5e71b3e2bbcae74dc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static unsigned lcDEScfbDesStrOneKey </td>
          <td>(</td>
          <td class="paramtype">register char *&#160;</td>
          <td class="paramname"><em>Dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">register char *&#160;</td>
          <td class="paramname"><em>Src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">register unsigned&#160;</td>
          <td class="paramname"><em>Siz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>CntKey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Encipher/decipher a block of memory using cipher-feedback mode. </p>
<p>Encipher/decipher a block of memory using cipher-feedback mode for each key</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Dst</td><td>Destination address </td></tr>
    <tr><td class="paramname">Src</td><td>Source address </td></tr>
    <tr><td class="paramname">Siz</td><td>Destination and source size in bytes </td></tr>
    <tr><td class="paramname">CntKey</td><td>Index of the used key</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jon BARRUTIA - 02/Jul/2002</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Egoitz GARAY - 09/Feb/2015: Disabled Visual Studio warning 4018 with a compiler pragma. </li>
</ul>

</div>
</div>
<a class="anchor" id="a27daabfde4f3a067ed09dcfa878acd7a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void lcDESforKey </td>
          <td>(</td>
          <td class="paramtype">register char *&#160;</td>
          <td class="paramname"><em>Dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">register char *&#160;</td>
          <td class="paramname"><em>Src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">register unsigned&#160;</td>
          <td class="paramname"><em>Siz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>NbKey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Encrypt/decrypt for each key. </p>
<p>Encrypt/decrypt for each key</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Dst</td><td>Destination address </td></tr>
    <tr><td class="paramname">Src</td><td>Source address </td></tr>
    <tr><td class="paramname">Siz</td><td>Destination and source size in bytes </td></tr>
    <tr><td class="paramname">NbKey</td><td>Number of keys used to encipher/decipher</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Nerea RAMOS - 25/Oct/2002 </dd></dl>

</div>
</div>
<a class="anchor" id="aad09e228de5ba8f344b68fe2f4d57429"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static unsigned long lcDESfunDes </td>
          <td>(</td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>Inp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>Key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Encryptation/Desencryptation function. </p>
<p>Encryptation/Desencryptation function</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Inp</td><td>Packed chaine to encrypt/desencrypt </td></tr>
    <tr><td class="paramname">Key</td><td>Key</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jon BARRUTIA - 02/Jul/2002 </dd></dl>

</div>
</div>
<a class="anchor" id="aeed50ea4b4145ede90e9abfaac5746cf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void lcDESip </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdes_pair.html">desPair</a> *&#160;</td>
          <td class="paramname"><em>Dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdes_pair.html">desPair</a> *&#160;</td>
          <td class="paramname"><em>Src</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>IP. </p>
<p>IP</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Dst</td><td>Destination address </td></tr>
    <tr><td class="paramname">Src</td><td>Source address</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jon BARRUTIA - 02/Jul/2002 </dd></dl>

</div>
</div>
<a class="anchor" id="ae755cfa759ec9681276c2aceeea2c398"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void lcDESipInv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdes_pair.html">desPair</a> *&#160;</td>
          <td class="paramname"><em>Dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">register unsigned long&#160;</td>
          <td class="paramname"><em>Lft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">register unsigned long&#160;</td>
          <td class="paramname"><em>Rgt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>IP inverse. </p>
<p>IP inverse</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Dst</td><td>Destination address </td></tr>
    <tr><td class="paramname">Lft</td><td>Left </td></tr>
    <tr><td class="paramname">Rgt</td><td>Right</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jon BARRUTIA - 02/Jul/2002 </dd></dl>

</div>
</div>
<a class="anchor" id="afb94bc4c3b3c82931f1c1c5a7d5d2211"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void lcDESisWeaKey </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>KeyBit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>IsWea</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return nonzero if the key is one of the well-known "weak" keys (FIPS Pub 74) </p>
<p>Return nonzero if the key is one of the well-known "weak" keys (FIPS Pub 74)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">KeyBit</td><td>8-byte key </td></tr>
    <tr><td class="paramname">IsWea</td><td>(out). Indicates if it is a weak key (if nonzero value)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jon BARRUTIA - 02/Jul/2002 </dd></dl>

</div>
</div>
<a class="anchor" id="a3a3c7b3caee660fa2d99eb65727b0510"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void lcDESkeyToTps </td>
          <td>(</td>
          <td class="paramtype">register unsigned char *&#160;</td>
          <td class="paramname"><em>Dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">register unsigned char *&#160;</td>
          <td class="paramname"><em>Src</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Dst</td><td>Destination address </td></tr>
    <tr><td class="paramname">Src</td><td>Source address</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jon BARRUTIA - 02/Jul/2002 </dd></dl>

</div>
</div>
<a class="anchor" id="a8caebf712703ad6d7809349d26feb1d4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void lcDESmakKey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdes_key_type.html">desKeyType</a> **&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>KeyBit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>KeySiz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Typ</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Given a key string, produce a key suitable for encryption, decryption. </p>
<p>Given a key string, produce a key suitable for encryption, decryption On input, key must be initialized to 0 or a pointer to adequate storage Set Typ to 1 for decryption, 0 for encryption</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>(out). Produced key </td></tr>
    <tr><td class="paramname">KeyBit</td><td>Source key </td></tr>
    <tr><td class="paramname">KeySiz</td><td>Source key size </td></tr>
    <tr><td class="paramname">Typ</td><td>Type: 1 for decryption, 0 for encryption</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jon BARRUTIA - 02/Jul/2002</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Egoitz GARAY - 09/Feb/2015: Disabled Visual Studio warning 4244 with a compiler pragma. </li>
</ul>

</div>
</div>
<a class="anchor" id="aecc15c11129b021efda00415b171602c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void lcDESpckBlk </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdes_pair.html">desPair</a> *&#160;</td>
          <td class="paramname"><em>Dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>Src</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Convert a string of bytes to a <a class="el" href="structdes_pair.html">desPair</a>. </p>
<p>Convert a string of bytes to a <a class="el" href="structdes_pair.html">desPair</a></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Dst</td><td>Destination address </td></tr>
    <tr><td class="paramname">Src</td><td>Source address</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jon BARRUTIA - 02/Jul/2002 </dd></dl>

</div>
</div>
<a class="anchor" id="af3fb25a676cd6c1ff7caf6dbb72733f3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void lcDESrotLft </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>Ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>Siz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Rotate to the left. </p>
<p>Rotate to the left</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Ptr</td><td>Destination address </td></tr>
    <tr><td class="paramname">Siz</td><td>Source address</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jon BARRUTIA - 02/Jul/2002 </dd></dl>

</div>
</div>
<a class="anchor" id="a0b84e498a23c494faf1e3e43f23a789b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int lcDESsetKey </td>
          <td>(</td>
          <td class="paramtype">register <a class="el" href="structdes_key_type.html">desKeyType</a> **&#160;</td>
          <td class="paramname"><em>KeyOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>KeyBit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>KeyStr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Typ</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Encrypt the key. </p>
<p>Encrypt the key. Because we are using CFB, we always encrypt. Since we'd like to be able to run the chips in either mode, perhaps CBC would be better. If CBC is used though, the last block must be handled in OFB mode.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">KeyOut</td><td>(out). Key structure </td></tr>
    <tr><td class="paramname">KeyBit</td><td>8-byte key </td></tr>
    <tr><td class="paramname">KeyStr</td><td>Key in ASCII format </td></tr>
    <tr><td class="paramname">Typ</td><td>Encryptation (0), desencryptation (1) mode</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>-1 - out of memory (program exits, and error reported)</li>
<li>0 - success</li>
<li>1 - key is a weak key</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jon BARRUTIA - 02/Jul/2002</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Jon BARRUTIA - 18/Jul/2002. Do not set to blanks the key </li>
</ul>

</div>
</div>
<a class="anchor" id="ac9ff8e35a0d73f656f4ebec70c9cc8f9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void lcDESsetKeyBit </td>
          <td>(</td>
          <td class="paramtype">register unsigned char *&#160;</td>
          <td class="paramname"><em>Dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">register char *&#160;</td>
          <td class="paramname"><em>Src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">register unsigned&#160;</td>
          <td class="paramname"><em>KeySiz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Shift each byte in a block of memory left by one bit. </p>
<p>Shift each byte in a block of memory left by one bit. Used because ASCII has high bit clear, and DES ignores low bit</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Dst</td><td>Destination address </td></tr>
    <tr><td class="paramname">Src</td><td>Source address </td></tr>
    <tr><td class="paramname">KeySiz</td><td>Size of the key</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jon BARRUTIA - 02/Jul/2002 </dd></dl>

</div>
</div>
<a class="anchor" id="a8d0c8391dc5b25b665c5c4e9032f46d4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void lcDESstrMAC </td>
          <td>(</td>
          <td class="paramtype">register char *&#160;</td>
          <td class="paramname"><em>Mac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">register char *&#160;</td>
          <td class="paramname"><em>KeyStr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">register unsigned&#160;</td>
          <td class="paramname"><em>KeyStrSiz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>Pad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute a Message Authentication code. </p>
<p>Compute a Message Authentication code according to FIPS Pub 113: "Computer Data
  Authentication" 1985 May 30</p>
<ul>
<li>Uses DES in CBC mode with IV = 0,input string padded on right with &lt;pad&gt; to positive multiple of DES_BLOCKSIZE bytes.</li>
<li>set Pad = '\0' for FIPS Pub 113.</li>
<li>set Pad = ' ' for FIPS Pub 112.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Mac</td><td>(out). Key in hexadecimal format </td></tr>
    <tr><td class="paramname">KeyStr</td><td>Key in ASCII format </td></tr>
    <tr><td class="paramname">KeyStrSiz</td><td>Size of the ASCII key </td></tr>
    <tr><td class="paramname">Pad</td><td>Character to pad the key </td></tr>
    <tr><td class="paramname">key</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jon BARRUTIA - 02/Jul/2002</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<p>&ndash; Amparo CAMARERO - 23/Oct/2012: Correct function header to match new DOXYGEN format </p>

</div>
</div>
<a class="anchor" id="af7ecd541d36876822878e43c3b22d225"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void lcDEStps </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>Src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>Dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>DstSiz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>SrcSiz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="descfb_8c.html#afa35a41db9e9b238ecebeaaf132260b9">bitIndexVector</a>&#160;</td>
          <td class="paramname"><em>Pmt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Transpose a key. </p>
<p>Transpose a key</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Src</td><td>Source address </td></tr>
    <tr><td class="paramname">Dst</td><td>Destination address </td></tr>
    <tr><td class="paramname">DstSiz</td><td>Destination size </td></tr>
    <tr><td class="paramname">SrcSiz</td><td>Source size </td></tr>
    <tr><td class="paramname">Pmt</td><td>Permuted choice</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jon BARRUTIA - 02/Jul/2002 </dd></dl>

</div>
</div>
<a class="anchor" id="a4648644c91ed9821c2b6d2b73e2e03e2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void lcDESunpckBlk </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>Dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdes_pair.html">desPair</a> *&#160;</td>
          <td class="paramname"><em>Src</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Convert a <a class="el" href="structdes_pair.html">desPair</a> to a string of bytes. </p>
<p>Convert a <a class="el" href="structdes_pair.html">desPair</a> to a string of bytes</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Dst</td><td>Destination address </td></tr>
    <tr><td class="paramname">Src</td><td>Source address</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jon BARRUTIA - 03/Jul/2002</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Egoitz GARAY - 18/Dec/2014. Added pragma to disable runtime scu checks.</li>
<li>Egoitz GARAY - 09/Feb/2015: Disabled Visual Studio warning 4244 with a compiler pragma. </li>
</ul>

</div>
</div>
<a class="anchor" id="a613422c3d505b23209128af9c66b7b2d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static unsigned char * lcDESunpckKeyBlk </td>
          <td>(</td>
          <td class="paramtype">register unsigned char *&#160;</td>
          <td class="paramname"><em>Dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">register unsigned char *&#160;</td>
          <td class="paramname"><em>Src</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Convert a key block to a bit vector. </p>
<p>Convert a key block to a bit vector</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Dst</td><td>Destination address </td></tr>
    <tr><td class="paramname">Src</td><td>Source address</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jon BARRUTIA - 02/Jul/2002 </dd></dl>

</div>
</div>
<a class="anchor" id="a22117697f36ffed2343f4b6f513d6325"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void lcDESxor </td>
          <td>(</td>
          <td class="paramtype">register char *&#160;</td>
          <td class="paramname"><em>Dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">register char *&#160;</td>
          <td class="paramname"><em>Src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">register char *&#160;</td>
          <td class="paramname"><em>Xor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">register unsigned&#160;</td>
          <td class="paramname"><em>Cnt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Do an xor between two strings. </p>
<p>Do an xor between two strings</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Dst</td><td>Destin </td></tr>
    <tr><td class="paramname">Src</td><td>Source </td></tr>
    <tr><td class="paramname">Xor</td><td>Xor string </td></tr>
    <tr><td class="paramname">Cnt</td><td>Index of the list to verify the valid of the data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jon BARRUTIA - 02/Jul/2002 </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="ab6e3159251b64b005d6301296dfa7700"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="descfb_8c.html#a46ea2ff48539c20e17d7bf23c62c5c9d">block</a> BadKey[16]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">   { 0xe0, 0x00, 0xe0, 0x00, 0xf0, 0x00, 0xf0, 0x00 },</div>
<div class="line">   { 0x00, 0xe0, 0x00, 0xe0, 0x00, 0xf0, 0x00, 0xf0 },</div>
<div class="line">   { 0xfe, 0x1e, 0xfe, 0x1e, 0xfe, 0x0e, 0xfe, 0x0e },</div>
<div class="line">   { 0x1e, 0xfe, 0x1e, 0xfe, 0x0e, 0xfe, 0x0e, 0xfe },</div>
<div class="line">   { 0xe0, 0x1e, 0xe0, 0x1e, 0xf0, 0x0e, 0xf0, 0x0e },</div>
<div class="line">   { 0x1e, 0xe0, 0x1e, 0xe0, 0x0e, 0xf0, 0x0e, 0xf0 },</div>
<div class="line">   { 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe },</div>
<div class="line">   { 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00, 0xfe, 0x00 },</div>
<div class="line">   { 0x00, 0x1e, 0x00, 0x1e, 0x00, 0x0e, 0x00, 0x0e },</div>
<div class="line">   { 0x1e, 0x00, 0x1e, 0x00, 0x0e, 0x00, 0x0e, 0x00 },</div>
<div class="line">   { 0xe0, 0xfe, 0xe0, 0xfe, 0xf0, 0xfe, 0xf0, 0xfe },</div>
<div class="line">   { 0xfe, 0xe0, 0xfe, 0xe0, 0xfe, 0xf0, 0xfe, 0xf0 },</div>
<div class="line">   { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },  </div>
<div class="line">   { 0xfe, 0xfe, 0xfe, 0xfe, 0xfe, 0xfe, 0xfe, 0xfe },  </div>
<div class="line">   { 0xe0, 0xe0, 0xe0, 0xe0, 0xf0, 0xf0, 0xf0, 0xf0 },  </div>
<div class="line">   { 0x1e, 0x1e, 0x1e, 0x1e, 0x0e, 0x0e, 0x0e, 0x0e },  </div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac5aec3492ecce29e42b1b66aac06a6d6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_key_item.html">KeyItem</a> DesKey[<a class="el" href="descfb_8h.html#a49d1b2ad1b5585be5bdc77ae25720f61">MAXCIPHER</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a2e9f5948a220de9cb6dc6998b28778e4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char IvcBit[] = { 0x12, 0x34, 0x56, 0x78, 0x90, 0xab, 0xcd, 0xef }</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aeceacc57b7037fe50fa7ca1dadeaca79"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char keyRotates[<a class="el" href="descfb_8c.html#ad6775b2ea5f0124e1d9ec2578bb912ba">STAGECOUNT</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">   1, 1, 2, 2, 2, 2, 2, 2,</div>
<div class="line">   1, 2, 2, 2, 2, 2, 2, 1,</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0e532b0a9035c6fc02af5dcb8b901fb3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char keyTr1[<a class="el" href="descfb_8c.html#a41ee6b3bbf473cd4170062630e76d85c">KEYBITS</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">   57, 49, 41, 33, 25, 17,  9,  1,</div>
<div class="line">   58, 50, 42, 34, 26, 18, 10,  2,</div>
<div class="line">   59, 51, 43, 35, 27, 19, 11,  3,</div>
<div class="line">   60, 52, 44, 36,                      </div>
<div class="line">   63, 55, 47, 39, 31, 23, 15,  7,</div>
<div class="line">   62, 54, 46, 38, 30, 22, 14,  6,</div>
<div class="line">   61, 53, 45, 37, 29, 21, 13,  5,</div>
<div class="line">                   28, 20, 12,  4</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a20a1620b02f81fa8d58defea52ef82eb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long sBoxp[8][64]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="descfb_8c.html">descfb.c</a></li>
    <li class="footer">Copyright &#169 ALMIS Informatica Financiera S.L. Reserved all the rights. Generated on Wed Jul 4 2018 22:30:32 for ALU by 
    <a href="http://www.almis.com">
    <img class="footer" src="DxyAlm.png" alt="ALMIS"/></a> </li>
  </ul>
</div>
</body>
</html>
