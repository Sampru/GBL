<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>ALU: src/tcp_ip.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ALU
   &#160;<span id="projectnumber">5.1</span>
   </div>
   <div id="projectbrief">ALMIS_utilities</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('tcp__ip_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">tcp_ip.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>TCP, TCP/IP interprocess communications primitives through sockets.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;unistd.h&gt;</code><br/>
<code>#include &lt;sys/types.h&gt;</code><br/>
<code>#include &lt;sys/socket.h&gt;</code><br/>
<code>#include &lt;netinet/in.h&gt;</code><br/>
<code>#include &lt;netdb.h&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;errno.h&gt;</code><br/>
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="alu__types_8h_source.html">alu_types.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="cst__def_8h_source.html">cst_def.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="dyn_def_8h_source.html">dynDef.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="err_def_8h_source.html">errDef.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="fml__def_8h_source.html">fml_def.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="glb_def_8h_source.html">glbDef.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="memoire_8h_source.html">memoire.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="tcp__def_8h_source.html">tcp_def.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="tm__def_8h_source.html">tm_def.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="trc__def_8h_source.html">trc_def.h</a>&gt;</code><br/>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ac9a2ef757bf63dbcbb68f3b4daabd069"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp__ip_8c.html#ac9a2ef757bf63dbcbb68f3b4daabd069">DATA_STEP</a>&#160;&#160;&#160;256</td></tr>
<tr class="separator:ac9a2ef757bf63dbcbb68f3b4daabd069"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21c7e34ba3c5ab6088ef6693f8d1b520"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp__ip_8c.html#a21c7e34ba3c5ab6088ef6693f8d1b520">TCP_TRT</a>&#160;&#160;&#160;1004</td></tr>
<tr class="memdesc:a21c7e34ba3c5ab6088ef6693f8d1b520"><td class="mdescLeft">&#160;</td><td class="mdescRight">Macrodefinition for messages of current module.  <a href="#a21c7e34ba3c5ab6088ef6693f8d1b520"></a><br/></td></tr>
<tr class="separator:a21c7e34ba3c5ab6088ef6693f8d1b520"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a130eec712b1a98d7c7dbd171228b3f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp__ip_8c.html#a2a130eec712b1a98d7c7dbd171228b3f">TCP_GETHOSTBYNAME</a>&#160;&#160;&#160;10</td></tr>
<tr class="separator:a2a130eec712b1a98d7c7dbd171228b3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d1cbcc62d6fea6af5fcb97281fc7d69"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp__ip_8c.html#a7d1cbcc62d6fea6af5fcb97281fc7d69">TCP_OPEN_SCK</a>&#160;&#160;&#160;20</td></tr>
<tr class="separator:a7d1cbcc62d6fea6af5fcb97281fc7d69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8774cefa4e9c8763e3d509d7900f984e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp__ip_8c.html#a8774cefa4e9c8763e3d509d7900f984e">TCP_LISTEN_SCK</a>&#160;&#160;&#160;30</td></tr>
<tr class="separator:a8774cefa4e9c8763e3d509d7900f984e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4aa779b8d2d1f3535516eba2308d7c73"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp__ip_8c.html#a4aa779b8d2d1f3535516eba2308d7c73">TCP_CONNECT_SCK</a>&#160;&#160;&#160;40</td></tr>
<tr class="separator:a4aa779b8d2d1f3535516eba2308d7c73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e03ab5d6e12dcef1b25e3d90b4a00ae"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp__ip_8c.html#a1e03ab5d6e12dcef1b25e3d90b4a00ae">TCP_CONNECT_DTA</a>&#160;&#160;&#160;41</td></tr>
<tr class="separator:a1e03ab5d6e12dcef1b25e3d90b4a00ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3619869f33d15ed9009fd11cc6937d34"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp__ip_8c.html#a3619869f33d15ed9009fd11cc6937d34">lcTCPgetLstErr</a> (char *ErrMsg)</td></tr>
<tr class="memdesc:a3619869f33d15ed9009fd11cc6937d34"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the last error message that has occurred in relation with sockets.  <a href="#a3619869f33d15ed9009fd11cc6937d34"></a><br/></td></tr>
<tr class="separator:a3619869f33d15ed9009fd11cc6937d34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59c94994e0719764abc51164a41f9999"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp__ip_8c.html#a59c94994e0719764abc51164a41f9999">lcTCPopen</a> (char *Hst, char *Usr, int Prt, char *Nam, int Typ, void *<a class="el" href="cmm__functions_8c.html#a9007429c4da92a7f40228fce69a2315a">LdSck</a>, struct sockaddr_in *Srv, int *Sck)</td></tr>
<tr class="memdesc:a59c94994e0719764abc51164a41f9999"><td class="mdescLeft">&#160;</td><td class="mdescRight">Open a TCP/IP socket.  <a href="#a59c94994e0719764abc51164a41f9999"></a><br/></td></tr>
<tr class="separator:a59c94994e0719764abc51164a41f9999"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a860188027ee019662369d5d20b796b49"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp__ip_8c.html#a860188027ee019662369d5d20b796b49">lcTCPregis</a> (int Sck, char *Hst, int Prt, char *Rmt, int Typ, char *Nam, void *<a class="el" href="cmm__functions_8c.html#a9007429c4da92a7f40228fce69a2315a">LdSck</a>)</td></tr>
<tr class="memdesc:a860188027ee019662369d5d20b796b49"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register a socket in the socket list.  <a href="#a860188027ee019662369d5d20b796b49"></a><br/></td></tr>
<tr class="separator:a860188027ee019662369d5d20b796b49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7143a09143243b1f095a813e7db897a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp__ip_8c.html#aa7143a09143243b1f095a813e7db897a">lcTCPtmo</a> (double Sec, struct timeval *TmOut)</td></tr>
<tr class="memdesc:aa7143a09143243b1f095a813e7db897a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise the timeout structure.  <a href="#aa7143a09143243b1f095a813e7db897a"></a><br/></td></tr>
<tr class="separator:aa7143a09143243b1f095a813e7db897a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58147aebdaedeadde83f41cb24c5a2dd"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp__ip_8c.html#a58147aebdaedeadde83f41cb24c5a2dd">lcTCPsetSckPrt</a> (int Sck, void *<a class="el" href="cmm__functions_8c.html#a9007429c4da92a7f40228fce69a2315a">LdSck</a>)</td></tr>
<tr class="memdesc:a58147aebdaedeadde83f41cb24c5a2dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set in LdSck the port that really has the socket Sck.  <a href="#a58147aebdaedeadde83f41cb24c5a2dd"></a><br/></td></tr>
<tr class="separator:a58147aebdaedeadde83f41cb24c5a2dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3fcaaabd2bfcadf457a3ff1bb005fb0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp__ip_8c.html#ad3fcaaabd2bfcadf457a3ff1bb005fb0">TCPtrace</a> (int Tra)</td></tr>
<tr class="memdesc:ad3fcaaabd2bfcadf457a3ff1bb005fb0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the trace level of the module.  <a href="#ad3fcaaabd2bfcadf457a3ff1bb005fb0"></a><br/></td></tr>
<tr class="separator:ad3fcaaabd2bfcadf457a3ff1bb005fb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e4232f0169311bea80e5af7f2991851"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp__ip_8c.html#a9e4232f0169311bea80e5af7f2991851">TCPini</a> (void **<a class="el" href="cmm__functions_8c.html#a9007429c4da92a7f40228fce69a2315a">LdSck</a>, int Tra)</td></tr>
<tr class="memdesc:a9e4232f0169311bea80e5af7f2991851"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise TCP module and set the trace level.  <a href="#a9e4232f0169311bea80e5af7f2991851"></a><br/></td></tr>
<tr class="separator:a9e4232f0169311bea80e5af7f2991851"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9925bcb564e9c901c1f1765a1105b874"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp__ip_8c.html#a9925bcb564e9c901c1f1765a1105b874">TCPgetSckPrt</a> (int Sck, int *PortNb)</td></tr>
<tr class="memdesc:a9925bcb564e9c901c1f1765a1105b874"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the port of an open socket.  <a href="#a9925bcb564e9c901c1f1765a1105b874"></a><br/></td></tr>
<tr class="separator:a9925bcb564e9c901c1f1765a1105b874"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88389d2744ff2791c637ffd52e174871"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp__ip_8c.html#a88389d2744ff2791c637ffd52e174871">TCPend</a> (void **<a class="el" href="cmm__functions_8c.html#a9007429c4da92a7f40228fce69a2315a">LdSck</a>)</td></tr>
<tr class="memdesc:a88389d2744ff2791c637ffd52e174871"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clean up TCP module.  <a href="#a88389d2744ff2791c637ffd52e174871"></a><br/></td></tr>
<tr class="separator:a88389d2744ff2791c637ffd52e174871"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac54ed96e689da0bcd4b9a00c37655608"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp__ip_8c.html#ac54ed96e689da0bcd4b9a00c37655608">TCPconnect</a> (char *Hst, char *Usr, int Prt, char *Nam, void *<a class="el" href="cmm__functions_8c.html#a9007429c4da92a7f40228fce69a2315a">LdSck</a>, int *Sck)</td></tr>
<tr class="memdesc:ac54ed96e689da0bcd4b9a00c37655608"><td class="mdescLeft">&#160;</td><td class="mdescRight">Open a TCP/IP socket and connect it to a given port.  <a href="#ac54ed96e689da0bcd4b9a00c37655608"></a><br/></td></tr>
<tr class="separator:ac54ed96e689da0bcd4b9a00c37655608"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae348005dc042d52519bde3a808bed997"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp__ip_8c.html#ae348005dc042d52519bde3a808bed997">TCPaccepting</a> (char *Hst, int Prt, char *Nam, void *<a class="el" href="cmm__functions_8c.html#a9007429c4da92a7f40228fce69a2315a">LdSck</a>, int *Sck)</td></tr>
<tr class="memdesc:ae348005dc042d52519bde3a808bed997"><td class="mdescLeft">&#160;</td><td class="mdescRight">Open a TCP/IP socket and bind it to a given port.  <a href="#ae348005dc042d52519bde3a808bed997"></a><br/></td></tr>
<tr class="separator:ae348005dc042d52519bde3a808bed997"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d98fd8cda2a5dd9f0142321c3061bdc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp__ip_8c.html#a2d98fd8cda2a5dd9f0142321c3061bdc">TCPaccept</a> (int Sck, char *Nam, void *<a class="el" href="cmm__functions_8c.html#a9007429c4da92a7f40228fce69a2315a">LdSck</a>, int *NewSck)</td></tr>
<tr class="memdesc:a2d98fd8cda2a5dd9f0142321c3061bdc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Accept a connection on a bound TCP/IP socket.  <a href="#a2d98fd8cda2a5dd9f0142321c3061bdc"></a><br/></td></tr>
<tr class="separator:a2d98fd8cda2a5dd9f0142321c3061bdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7b8dc469d47fc8e95c77e668d7584f7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp__ip_8c.html#af7b8dc469d47fc8e95c77e668d7584f7">TCPsend</a> (int Sck, char *Msg, int Siz, int *Nbw)</td></tr>
<tr class="memdesc:af7b8dc469d47fc8e95c77e668d7584f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write a stream into a connected socket.  <a href="#af7b8dc469d47fc8e95c77e668d7584f7"></a><br/></td></tr>
<tr class="separator:af7b8dc469d47fc8e95c77e668d7584f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac23aadcf858b15037b23b3eafc00baf7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp__ip_8c.html#ac23aadcf858b15037b23b3eafc00baf7">TCPselect</a> (void *<a class="el" href="cmm__functions_8c.html#a9007429c4da92a7f40228fce69a2315a">LdSck</a>, double *Tmo, int *NbRdy)</td></tr>
<tr class="memdesc:ac23aadcf858b15037b23b3eafc00baf7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Select sockets ready for reading.  <a href="#ac23aadcf858b15037b23b3eafc00baf7"></a><br/></td></tr>
<tr class="separator:ac23aadcf858b15037b23b3eafc00baf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52485082bdaba827b25831aa4dd7eb79"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp__ip_8c.html#a52485082bdaba827b25831aa4dd7eb79">TCPstep</a> (int Sck, int Stp, void *<a class="el" href="cmm__functions_8c.html#a9007429c4da92a7f40228fce69a2315a">LdSck</a>)</td></tr>
<tr class="memdesc:a52485082bdaba827b25831aa4dd7eb79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Specify the data allocation step of a socket data.  <a href="#a52485082bdaba827b25831aa4dd7eb79"></a><br/></td></tr>
<tr class="separator:a52485082bdaba827b25831aa4dd7eb79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa87cceab305afbec0f2b52630cab53af"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp__ip_8c.html#aa87cceab305afbec0f2b52630cab53af">TCPrecv</a> (int Sck, int Siz, char *Buf, int *Nbr)</td></tr>
<tr class="memdesc:aa87cceab305afbec0f2b52630cab53af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read a stream from a connected socket.  <a href="#aa87cceab305afbec0f2b52630cab53af"></a><br/></td></tr>
<tr class="separator:aa87cceab305afbec0f2b52630cab53af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add9d639729ff7a52c5d7f70cc59eede5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp__ip_8c.html#add9d639729ff7a52c5d7f70cc59eede5">TCPrecvAll</a> (void *<a class="el" href="cmm__functions_8c.html#a9007429c4da92a7f40228fce69a2315a">LdSck</a>)</td></tr>
<tr class="memdesc:add9d639729ff7a52c5d7f70cc59eede5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read a stream from connected sockets.  <a href="#add9d639729ff7a52c5d7f70cc59eede5"></a><br/></td></tr>
<tr class="separator:add9d639729ff7a52c5d7f70cc59eede5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ab9236c62167d23cdb4a0487f777c2b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp__ip_8c.html#a4ab9236c62167d23cdb4a0487f777c2b">TCPalloc</a> (int CntSck, void *<a class="el" href="cmm__functions_8c.html#a9007429c4da92a7f40228fce69a2315a">LdSck</a>, char **Dat, int *Siz, int *Use)</td></tr>
<tr class="memdesc:a4ab9236c62167d23cdb4a0487f777c2b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find data information and allocate memory if necessary.  <a href="#a4ab9236c62167d23cdb4a0487f777c2b"></a><br/></td></tr>
<tr class="separator:a4ab9236c62167d23cdb4a0487f777c2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12fbf0b7e3468a9376e39a9e868746c3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp__ip_8c.html#a12fbf0b7e3468a9376e39a9e868746c3">TCPgetData</a> (int CntSck, void *<a class="el" href="cmm__functions_8c.html#a9007429c4da92a7f40228fce69a2315a">LdSck</a>, char **Dat, int *Use)</td></tr>
<tr class="memdesc:a12fbf0b7e3468a9376e39a9e868746c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a pointer to the data read on a socket and its size.  <a href="#a12fbf0b7e3468a9376e39a9e868746c3"></a><br/></td></tr>
<tr class="separator:a12fbf0b7e3468a9376e39a9e868746c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a752168dd1a82dbfe9718ba95051ca9d1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp__ip_8c.html#a752168dd1a82dbfe9718ba95051ca9d1">TCPdiscard</a> (int CntSck, void *<a class="el" href="cmm__functions_8c.html#a9007429c4da92a7f40228fce69a2315a">LdSck</a>, int Siz)</td></tr>
<tr class="memdesc:a752168dd1a82dbfe9718ba95051ca9d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Discard data that has been already read.  <a href="#a752168dd1a82dbfe9718ba95051ca9d1"></a><br/></td></tr>
<tr class="separator:a752168dd1a82dbfe9718ba95051ca9d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2eea5336be576f596186173335544c1a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp__ip_8c.html#a2eea5336be576f596186173335544c1a">TCPclose</a> (int Sck, void *<a class="el" href="cmm__functions_8c.html#a9007429c4da92a7f40228fce69a2315a">LdSck</a>)</td></tr>
<tr class="memdesc:a2eea5336be576f596186173335544c1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close a socket.  <a href="#a2eea5336be576f596186173335544c1a"></a><br/></td></tr>
<tr class="separator:a2eea5336be576f596186173335544c1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a7aa38aa028456859096971cc7d699cc6"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp__ip_8c.html#a7aa38aa028456859096971cc7d699cc6">lcTrace</a> = 0</td></tr>
<tr class="separator:a7aa38aa028456859096971cc7d699cc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5286b07b5d7869d2db33b1fa9e79a29"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp__ip_8c.html#ae5286b07b5d7869d2db33b1fa9e79a29">lcStep</a> = 256</td></tr>
<tr class="separator:ae5286b07b5d7869d2db33b1fa9e79a29"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>TCP, TCP/IP interprocess communications primitives through sockets. </p>
<dl class="section user"><dt>Header file</dt><dd><a class="el" href="tcp__def_8h.html" title="Interprocess communications primitives through sockets.">tcp_def.h</a></dd></dl>
<dl class="section user"><dt>Library</dt><dd>alu</dd></dl>
<p>This module handles high level socket TCP/IP interprocess communication primitives encapsulating the particularities of the different platforms.</p>
<ul>
<li>Only AF_INET/SOCK_STREAM sockets are considered here.</li>
<li>LdSck structure:</li>
</ul>
<ul>
<li>Col Typ Siz Description <hr/>
</li>
<li>sck int Socket identifier</li>
<li>nam str 20 Socket name</li>
<li>hst str 20 Host name</li>
<li>prt int Port (real)</li>
<li>rmt str 20 Remote host name (not treated so far)</li>
<li>typ int Type (TCP_TO_ACCEPT, TCP_CONNECTED, TCP_ACCEPTED)</li>
<li>rdy int Ready</li>
<li>dat ptr Data read (NULL: no data)</li>
<li>siz int Size of the reserved data</li>
<li>use int Number of bytes of dat in use</li>
<li>stp int Allocation step</li>
<li>snt int Total number of bytes sent (not treated so far)</li>
<li>snm int Total number of messages sent (not treated so far)</li>
<li>rcv int Total number of bytes received (only if using TCPrecvAll)</li>
<li>rcm int Total number of messages received (not treated so far) <hr/>
</li>
<li>Characteristics of the TCP/IP protocol:</li>
<li>- connection-based: both ends keep a logical connection to communicate</li>
<li>- byte streams: we write a stream of bytes, not separated in messages</li>
<li>- sequenced: when information arrives it does in correct sequence</li>
<li>- reliable: when the information doesn't arrive we get an error</li>
<li>- two-way: we can communicate in both senses with a socket</li>
</ul>
<ul>
<li>TCP/IP connection</li>
</ul>
<ul>
<li>The TCP/IP communication is maintained after the connection of both peers. <hr/>
</li>
<li>TCP/IP streams must be correctly understood.</li>
</ul>
<ul>
<li>We must understand the communication data as a stream of bytes (not as a string of characters or as separate messages). Any byte may be transmitted (even the &lt;null&gt; byte) so it may be dangerous to use, within this module, string manipulating functions.</li>
</ul>
<ul>
<li>The sender may write several messages before the receiver reads them all (or some of them, according to the size of the buffer) together as a stream. Messages must be separated by the user, for example, by writing a header indicating the number of bytes of the message. If we only exchange strings the &lt;null&gt; terminator may delimit messages from each other.</li>
</ul>
<ul>
<li>Be careful, if a connection is opened, a message is sent and the connection closed. A new connection with the receiver couldn't be opened before the receiver reads the previous message.</li>
</ul>
<ul>
<li>Examples to illustrate the nature of sockets are provided:</li>
<li>- ss.c / sr.c (Sender / Receiver)</li>
<li>- ss1.c / sr1.c (Sender / Receiver)</li>
<li>- ss2.c / sr2.c (Sender / Receiver) <hr/>
</li>
<li>TCP/IP sequenced/reliable</li>
</ul>
<ul>
<li>Messages are guaranteed by the protocol to arrive in the correct order at which they have been sent in a reliable manner: if an error occurs and the message doesn't reach its destination this error will be transmitted to the sender. <hr/>
</li>
<li>TCP/IP two/way (bidirectional) communication</li>
</ul>
<ul>
<li>Once a connection has been established on a socket any of the ends (peers) may send and receive information through the connected socket.</li>
</ul>
<ul>
<li>Communication is often bidirectional at the application level to maintain a protocol at this level but normally one will send information and the other will confirm.</li>
</ul>
<ul>
<li>Note that it's wrong to presume that the communications initiator will send or receive information as this depends on the service (application).</li>
</ul>
<ul>
<li>For example, a FTP server will be accepting connections. For each new connection the initiator (client program) may put or get files. The FTP protocol establishes the information that the client may ask and how this information will be provided. <hr/>
</li>
<li>Trace levels:</li>
<li>- 2: traces information sent/received <h2>- - 3: traces entering/exiting functions</h2>
</li>
</ul>
<ul>
<li>Specific system functions used/related:</li>
<li>Unix Windows <hr/>
</li>
<li>accept ()</li>
<li>bind ()</li>
<li>connect ()</li>
<li>close () closesocket ()</li>
<li>getsockname ()</li>
<li>listen ()</li>
<li>read () recv ()</li>
<li>select ()</li>
<li>sendto ()</li>
<li>socket ()</li>
<li>write () send () <hr/>
</li>
<li>Additional information:</li>
</ul>
<ul>
<li>winsock.htm</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Isma ETXEBERRIA - 23/Aug/2000 </dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ac9a2ef757bf63dbcbb68f3b4daabd069"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DATA_STEP&#160;&#160;&#160;256</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a1e03ab5d6e12dcef1b25e3d90b4a00ae"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCP_CONNECT_DTA&#160;&#160;&#160;41</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a4aa779b8d2d1f3535516eba2308d7c73"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCP_CONNECT_SCK&#160;&#160;&#160;40</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a2a130eec712b1a98d7c7dbd171228b3f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCP_GETHOSTBYNAME&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a8774cefa4e9c8763e3d509d7900f984e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCP_LISTEN_SCK&#160;&#160;&#160;30</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a7d1cbcc62d6fea6af5fcb97281fc7d69"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCP_OPEN_SCK&#160;&#160;&#160;20</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a21c7e34ba3c5ab6088ef6693f8d1b520"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCP_TRT&#160;&#160;&#160;1004</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Macrodefinition for messages of current module. </p>
<p>Macrodefinitions for message of current module</p>
<dl class="section author"><dt>Author</dt><dd>Name SURNAME - DD/Mmm/YYYY </dd></dl>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a3619869f33d15ed9009fd11cc6937d34"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int lcTCPgetLstErr </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>ErrMsg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the last error message that has occurred in relation with sockets. </p>
<p>Get the last error message that has occurred in relation with sockets.</p>
<ul>
<li>This function has different ways for obtaining the error message depending on the operating system. Unix system, will set the error code in 'errno' variable, but the error codes set by Windows sockets are not made available through the 'errno' variable. For Windows sockets, the error are recovered using WSAGetLastError function.</li>
</ul>
<ul>
<li>The returned message will have the format:</li>
<li>- "(ErrCod &lt;cod&gt;) - &lt;msg&gt;"</li>
<li>- In case a valid message is not found for the captured error code, the message will be: "(ErrCod &lt;cod&gt;) - Unkown error"</li>
<li>- In case an error code is not found, the message will be "(ErrCod &lt;cod&gt;) - No error found"</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ErrMsg</td><td>Buffer in which the error message will be returned. It must be previously reserved as ERR_DES_TYPE</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Josune BIKUNA - 16/Feb/2011 </dd></dl>

</div>
</div>
<a class="anchor" id="a59c94994e0719764abc51164a41f9999"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int lcTCPopen </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Hst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Usr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Prt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Nam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Typ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdSck</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct sockaddr_in *&#160;</td>
          <td class="paramname"><em>Srv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>Sck</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Open a TCP/IP socket. </p>
<p>Open a TCP/IP socket</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Hst</td><td>Socket hostname. If NULL current hostname. </td></tr>
    <tr><td class="paramname">Usr</td><td>User name </td></tr>
    <tr><td class="paramname">Prt</td><td>Socket port number. If 0 the system will assign a port number. </td></tr>
    <tr><td class="paramname">Nam</td><td>Name of this communication point </td></tr>
    <tr><td class="paramname">Typ</td><td>Type of socket (TCP_TO_ACCEPT, TCP_CONNECTED, TCP_ACCEPTED) </td></tr>
    <tr><td class="paramname">Hst</td><td>Socket hostname. If NULL current hostname. </td></tr>
    <tr><td class="paramname">Usr</td><td>User name </td></tr>
    <tr><td class="paramname">Prt</td><td>Socket port number. If 0 the system will assign a port number. </td></tr>
    <tr><td class="paramname">Nam</td><td>Name of this communication point </td></tr>
    <tr><td class="paramname">Typ</td><td>Type of socket (TCP_TO_ACCEPT, TCP_CONNECTED, TCP_ACCEPTED) </td></tr>
    <tr><td class="paramname">LdSck</td><td>Socket list </td></tr>
    <tr><td class="paramname">Srv</td><td>(OUT) Srv structure initialised. </td></tr>
    <tr><td class="paramname">Sck</td><td>(OUT) Socket identifier. This identifier is the "file descriptor" </td></tr>
    <tr><td class="paramname">Srv</td><td>(OUT) Srv structure initialised. </td></tr>
    <tr><td class="paramname">Sck</td><td>(OUT) Socket identifier. This identifier is the "file descriptor"</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Isma ETXEBERRIA - 23/Aug/2000</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<p>&ndash; Nerea RAMOS - 10/Apr/2002 Control if LdSck parameter is NULL &ndash; Nerea RAMOS - 25/Apr/2002 Change ERRsetError &ndash;&gt; ERRsetInfo and added Usr parameter. &ndash; Alex RODRIGUEZ - 10/Jun/2004. Add ERRchk () to calls of ERRsetXXX (). &ndash; Alex RODRIGUEZ - 14/Mar/2006. Avoid compilation warnings. &ndash; Nerea RAMOS - 10/Apr/2002 Control if LdSck parameter is NULL &ndash; Nerea RAMOS - 25/Apr/2002 Change ERRsetError &ndash;&gt; ERRsetInfo and added Usr parameter. &ndash; Alex RODRIGUEZ - 10/Jun/2004. Add ERRchk () to calls of ERRsetXXX (). &ndash; Alex RODRIGUEZ - 14/Mar/2006. Avoid compilation warnings. &ndash; Josune BIKUNA - 16/Feb/2011: Use lcTCPgetLstErr for getting the error message. It is based on getting the errors in different ways depending on the operating system &ndash; David ROMERO - 04/Mar/2015: Added a cast to int in "socket" function, this cast corrects warning C4244.</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span>sockaddr_in Srv;</div>
<div class="line">...</div>
<div class="line"></div>
<div class="line">ERRchk (<a class="code" href="tcp__ip_8c.html#a59c94994e0719764abc51164a41f9999" title="Open a TCP/IP socket.">lcTCPopen</a> (Hst, Prt, Nam, Typ, &amp;Srv, <a class="code" href="cmm__functions_8c.html#a9007429c4da92a7f40228fce69a2315a">LdSck</a>, &amp;Sck));</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="a860188027ee019662369d5d20b796b49"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int lcTCPregis </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Sck</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Hst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Prt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Rmt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Typ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Nam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdSck</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Register a socket in the socket list. </p>
<p>Register a socket in the socket list</p>
<ul>
<li>We register a socket to initialise information that will be handy to carry out block operations. A socket may be registered in more than one list.</li>
<li>However, each socket should only read using one of the lists unless all all information is always consumed.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Sck</td><td>Socket </td></tr>
    <tr><td class="paramname">Hst</td><td>Host </td></tr>
    <tr><td class="paramname">Prt</td><td>Port </td></tr>
    <tr><td class="paramname">Rmt</td><td>Remote host name (not treated so far) </td></tr>
    <tr><td class="paramname">Typ</td><td>Type of socket </td></tr>
    <tr><td class="paramname">Nam</td><td>Name of the socket </td></tr>
    <tr><td class="paramname">LdSck</td><td>Socket list</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Isma ETXEBERRIA - 10/Sep/2000</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Ismael SERRANO - 18/Sep/2006. Add mutex management</li>
<li>Ismael SERRANO - 22/Apr/2008. Free mutex at ERRend</li>
<li>Ismael SERRANO - 18/Sep/2006: Add mutex management</li>
<li>Lorea NAVARRO - 11/Oct/2012: correct warnings generated by doxygen tool. </li>
</ul>

</div>
</div>
<a class="anchor" id="a58147aebdaedeadde83f41cb24c5a2dd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int lcTCPsetSckPrt </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Sck</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdSck</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set in LdSck the port that really has the socket Sck. </p>
<p>Set in LdSck the port that really has the socket Sck. Useful for sockets whose port is automatically assigned by system.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Sck</td><td>Socket identifier. </td></tr>
    <tr><td class="paramname">LdSck</td><td>List of sockets</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Basilio TAMAYO - 11/May/2001</dd></dl>
<div class="fragment"><div class="line"><a class="code" href="err_def_8h.html#a4ba6b8261664a96881091edeef199a03">ERRchk</a> (<a class="code" href="tcp__ip_8c.html#a58147aebdaedeadde83f41cb24c5a2dd" title="Set in LdSck the port that really has the socket Sck.">lcTCPsetSckPrt</a> (Sck, <a class="code" href="cmm__functions_8c.html#a9007429c4da92a7f40228fce69a2315a">LdSck</a>));</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="aa7143a09143243b1f095a813e7db897a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int lcTCPtmo </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timeval *&#160;</td>
          <td class="paramname"><em>TmOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialise the timeout structure. </p>
<p>Initialise the timeout structure. Note that this function encapsulates this structure within this module, and we'll always use a double out of the module.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Sec</td><td>Timeout in seconds (with decimals) </td></tr>
    <tr><td class="paramname">TmOut</td><td>Timeout structure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>Error code (0 if OK)</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Isma ETXEBERRIA - 25/Aug/2000 &ndash; Alex RODRIGUEZ - 14/Mar/2006. Avoid lint warnings.</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<p>&ndash; Alex RODRIGUEZ - 14/Mar/2006. Avoid lint warnings.</p>
<ul>
<li>Edurne GORDOA - 23/Mar/2007: Bug corrected: correct cast in conversion to microseconds </li>
</ul>

</div>
</div>
<a class="anchor" id="a2d98fd8cda2a5dd9f0142321c3061bdc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TCPaccept </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Sck</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Nam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdSck</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>NewSck</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Accept a connection on a bound TCP/IP socket. </p>
<p>Accept a connection on a bound TCP/IP socket.</p>
<ul>
<li>A new socket NewSck is created and communication is carried out through this new socket. Sck may be used to accept more connections.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Sck</td><td>Socket identifier. </td></tr>
    <tr><td class="paramname">Nam</td><td>Name of the accepted socket </td></tr>
    <tr><td class="paramname">LdSck</td><td>Socket list </td></tr>
    <tr><td class="paramname">NewSck</td><td>(out) Accepted connection socket</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Isma ETXEBERRIA - 23/Aug/2000</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Ismael SERRANO - 18/Sep/2006: Add mutex management</li>
</ul>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Ismael SERRANO - 18/Sep/2006: Add mutex management</li>
<li>David ROMERO - 04/Mar/2015: Added a cast to int in "accept" function, this cast corrects warning C4244.</li>
</ul>
<div class="fragment"><div class="line"><a class="code" href="err_def_8h.html#a4ba6b8261664a96881091edeef199a03">ERRchk</a> (<a class="code" href="tcp__def_8h.html#acdd57f75da5421d19f5ca57e17f8c9aa" title="Accept a connection on a bound TCP/IP socket.">TCPaccept</a> (Sck, Nam, <a class="code" href="cmm__functions_8c.html#a9007429c4da92a7f40228fce69a2315a">LdSck</a>, &amp;NewSck));</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="ae348005dc042d52519bde3a808bed997"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TCPaccepting </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Hst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Prt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Nam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdSck</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>Sck</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Open a TCP/IP socket and bind it to a given port. </p>
<p>Open a TCP/IP socket and bind it to a given port.</p>
<ul>
<li>The socket is left ready to accept connections.</li>
<li>We can accept connections (see TCPaccept) and communicate (read or write) on each of the new sockets created with each of these connections.</li>
<li>If the port number passed as parameter is 0, set the port number from a range of ports defined by the user. This range of ports is defined with the constant values 'aluCmPrtMn' and 'aluCmPrtMx', which are minimum and maximun ports of the available range respectively.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Hst</td><td>Socket hostname. If NULL current hostname. </td></tr>
    <tr><td class="paramname">Prt</td><td>Socket port number. If 0 the system will assign a port number. </td></tr>
    <tr><td class="paramname">Nam</td><td>Name of this communication point </td></tr>
    <tr><td class="paramname">LdSck</td><td>Socket list </td></tr>
    <tr><td class="paramname">Sck</td><td>(out) Socket identifier number</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Isma ETXEBERRIA - 23/Aug/2000</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<p>&ndash; Basilio TAMAYO - 11/May/2001 If Prt is zero the system will assign a port and the list must be modified &ndash; Nerea RAMOS - 25/Apr/2002 Get user value and use it in lcTCPopen &ndash; Alex RODRIGUEZ - 10/Jun/2004. Add ERRchk () to calls of ERRsetXXX (). &ndash; Alex RODRIGUEZ - 27/Aug/2004. FoxUsr &ndash;&gt; AppUsr. &ndash; Josune BIKUNA - 06/Jul/2005. If the socket port is 0, do not let the system assign a port number, get a port number from a user defined range of ports instead. &ndash; Josune BIKUNA - 06/Jul/2005. If the socket port is 0, do not let the system assign a port &ndash; Alex RODRIGUEZ - 14/Mar/2006. Avoid lint warnings.</p>
<ul>
<li>Ismael SERRANO - 18/Sep/2006: Add mutex management &ndash; Ismael SERRANO - 18/Sep/2006: Add mutex management &ndash; Edurne GORDOA - 08/May/2007: Copy connected user global variable to a local buffer. &ndash; Nerea RAMOS - 05/Jun/2007: Do not use listening queue for incoming connections in hard code, &ndash; Nerea RAMOS - 06/Jun/2007: Correct parameters in CSTreadVal &ndash; Ismael SERRANO - 22/Apr/2008. Free mutex at ERRend &ndash; Basilio TAMAYO - 11/May/2001 If Prt is zero the system will assign a port and the list must be modified &ndash; Nerea RAMOS - 25/Apr/2002 Get user value and use it in lcTCPopen &ndash; Alex RODRIGUEZ - 10/Jun/2004. Add ERRchk () to calls of ERRsetXXX (). &ndash; Alex RODRIGUEZ - 27/Aug/2004. FoxUsr &ndash;&gt; AppUsr. &ndash; Josune BIKUNA - 06/Jul/2005. If the socket port is 0, do not let the system assign a port number, get a port number from a user defined range of ports instead. &ndash; Alex RODRIGUEZ - 14/Mar/2006. Avoid lint warnings.</li>
<li>Edurne GORDOA - 08/May/2007: Copy connected user global variable to a local buffer.</li>
<li>Nerea RAMOS - 05/Jun/2007: Do not use listening queue for incoming connections in hard code, use an application option instead.</li>
<li>Nerea RAMOS - 06/Jun/2007: Correct parameters in CSTreadVal<ul>
<li>Josune BIKUNA - 16/Feb/2011: Use lcTCPgetLstErr for getting the error message. It is based on getting the errors in different ways depending on the operating system</li>
<li>Josune BIKUNA - 21/Feb/2011: Initialise to NULL the variable PtrUsr just in case "AppUsr" global variable is not defined</li>
<li><p class="startli">Lorea NAVARRO - 11/Oct/2012: correct warnings generated by doxygen tool. examples: int Sck;</p>
<p class="startli">ERRchk (TCPaccepting (NULL, 0, LdSck, &amp;Sck)); ERRchk (TCPaccepting (Name, Port, LdSck, &amp;Sck)); </p>
</li>
</ul>
</li>
</ul>

</div>
</div>
<a class="anchor" id="a4ab9236c62167d23cdb4a0487f777c2b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TCPalloc </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>CntSck</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdSck</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>Dat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>Siz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>Use</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find data information and allocate memory if necessary. </p>
<p>Find data information and allocate memory if necessary</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CntSck</td><td>Socket line. </td></tr>
    <tr><td class="paramname">LdSck</td><td>Socket list </td></tr>
    <tr><td class="paramname">Dat</td><td>Data pointer </td></tr>
    <tr><td class="paramname">Siz</td><td>Size </td></tr>
    <tr><td class="paramname">Use</td><td>Bytes used</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Isma ETXEBERRIA - 10/Sep/2000</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Nerea RAMOS - 22/May/2006: Make it public</li>
<li>Ismael SERRANO - 18/Sep/2006: Add mutex management</li>
<li>Ismael SERRANO - 22/Apr/2008. Free mutex at ERRend</li>
<li>Ismael SERRANO - 18/Sep/2006: Add mutex management </li>
</ul>

</div>
</div>
<a class="anchor" id="a2eea5336be576f596186173335544c1a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TCPclose </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Sck</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdSck</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close a socket. </p>
<p>Close a socket</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Sck</td><td>Socket identifier. </td></tr>
    <tr><td class="paramname">LdSck</td><td>List of sockets (NULL if no list)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Isma ETXEBERRIA - 11/Sep/2000</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Ismael SERRANO - 18/Sep/2006: Add mutex management</li>
</ul>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Ismael SERRANO - 18/Sep/2006: Add mutex management</li>
</ul>
<div class="fragment"><div class="line"><a class="code" href="err_def_8h.html#a4ba6b8261664a96881091edeef199a03">ERRchk</a> (<a class="code" href="tcp__def_8h.html#a72749237be1270ac46e38f890637885c" title="Close a socket.">TCPclose</a> (Sck, <a class="code" href="cmm__functions_8c.html#a9007429c4da92a7f40228fce69a2315a">LdSck</a>));</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="ac54ed96e689da0bcd4b9a00c37655608"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TCPconnect </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Hst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Usr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Prt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Nam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdSck</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>Sck</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Open a TCP/IP socket and connect it to a given port. </p>
<p>Open a TCP/IP socket and connect it to a given port.</p>
<ul>
<li>There must be a peer accepting connections at the other end. Otherwise an error will be produced.</li>
<li>This means that the end issuing this function must always be executed after the end that accepts connections (or must be able to wait).</li>
<li>It tries to stablish the connection until the value parametrised in the maximum number of trying (aluCmTryNb) application option.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Hst</td><td>Socket hostname. If NULL current hostname. </td></tr>
    <tr><td class="paramname">Usr</td><td>User name </td></tr>
    <tr><td class="paramname">Prt</td><td>Socket port number. If 0 the system will assign a port number. </td></tr>
    <tr><td class="paramname">Nam</td><td>Name of this communication point </td></tr>
    <tr><td class="paramname">LdSck</td><td>Socket list </td></tr>
    <tr><td class="paramname">Sck</td><td>(out) Socket identifier. This identifier is the "file descriptor"</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Isma ETXEBERRIA - 23/Aug/2000</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Nerea RAMOS - 10/Apr/2002 Control if LdSck parameter is NULL</li>
<li>Nerea RAMOS - 25/Apr/2002 Call to ERRsetInfo if connection failed and added Usr parameter.</li>
<li>Alex RODRIGUEZ - 10/Jun/2004. Add ERRchk () to calls of ERRsetXXX ().</li>
<li>Ismael SERRANO - 18/Sep/2006: Add mutex management</li>
<li>Ismael SERRANO - 18/Sep/2006: Add mutex management</li>
<li>Edurne GORDOA - 31/May/2007: Take into account maximum number of tryings to stablish connection</li>
<li>Ismael SERRANO - 22/Apr/2008. Free mutex at ERRend</li>
<li>Josune BIKUNA - 16/Feb/2011: Use lcTCPgetLstErr for getting the error message. It is based on getting the errors in different ways depending on the operating system</li>
</ul>
<div class="fragment"><div class="line"><a class="code" href="err_def_8h.html#a4ba6b8261664a96881091edeef199a03">ERRchk</a> (<a class="code" href="tcp__def_8h.html#ac378f2cac7421149e14648c66764093c" title="Open a TCP/IP socket and connect it to a given port.">TCPconnect</a> (Hst, Prt, Nam, <a class="code" href="cmm__functions_8c.html#a9007429c4da92a7f40228fce69a2315a">LdSck</a>, &amp;Sck));</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="a752168dd1a82dbfe9718ba95051ca9d1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TCPdiscard </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>CntSck</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdSck</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Siz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Discard data that has been already read. </p>
<p>Discard data that has been already read.</p>
<ul>
<li>When all the information has not been used the valid information will be shifted appropriately.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CntSck</td><td>Socket counter </td></tr>
    <tr><td class="paramname">LdSck</td><td>Socket list </td></tr>
    <tr><td class="paramname">Siz</td><td>Size of the block to discard</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>Error code (0 if OK)</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Isma ETXEBERRIA - 11/Sep/2000 </dd></dl>

</div>
</div>
<a class="anchor" id="a88389d2744ff2791c637ffd52e174871"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TCPend </td>
          <td>(</td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>LdSck</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clean up TCP module. </p>
<p>Clean up TCP module. This function must be called for the PC version to clean up winsock related information.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">LdSck</td><td>Socket list</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Isma ETXEBERRIA - 10/Sep/2000</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Ismael SERRANO - 18/Sep/2006: Add mutex management</li>
<li>Ismael SERRANO - 22/Apr/2008. Free mutex at ERRend</li>
</ul>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Ismael SERRANO - 18/Sep/2006: Add mutex management </li>
</ul>

</div>
</div>
<a class="anchor" id="a12fbf0b7e3468a9376e39a9e868746c3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TCPgetData </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>CntSck</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdSck</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>Dat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>Use</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a pointer to the data read on a socket and its size. </p>
<p>Get a pointer to the data read on a socket and its size</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CntSck</td><td>Socket </td></tr>
    <tr><td class="paramname">LdSck</td><td>Socket list </td></tr>
    <tr><td class="paramname">Dat</td><td>(out) Data - see TCPdiscard </td></tr>
    <tr><td class="paramname">Use</td><td>(out) Size of the used part</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>Error code (0 if OK)</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Isma ETXEBERRIA - 11/Sep/2000</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Nerea RAMOS - 09/Jun/2003: ERRass was used wrong</li>
<li>Lorea NAVARRO - 11/Oct/2012: correct warnings generated by doxygen tool. </li>
</ul>

</div>
</div>
<a class="anchor" id="a9925bcb564e9c901c1f1765a1105b874"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TCPgetSckPrt </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Sck</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>PortNb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the port of an open socket. </p>
<p>Retrieve the port of an open socket</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Sck</td><td>Socket identifier </td></tr>
    <tr><td class="paramname">PortNb</td><td>(out) Port number</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Isma ETXEBERRIA - 11/Sep/2000</dd></dl>
<div class="fragment"><div class="line"><a class="code" href="err_def_8h.html#a4ba6b8261664a96881091edeef199a03">ERRchk</a> (<a class="code" href="tcp__def_8h.html#abbfc92b84ea15bd4df217283ce3be495" title="Retrieve the port of an open socket.">TCPgetSckPrt</a> (Sck, &amp;PortNb));</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="a9e4232f0169311bea80e5af7f2991851"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TCPini </td>
          <td>(</td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>LdSck</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Tra</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise TCP module and set the trace level. </p>
<p>Initialise TCP module and set the trace level.</p>
<ul>
<li>It initialises the LdSck list, which may be used to select ready sockets, retrieve information and show traces. See its structure in the module header.</li>
<li>Note that this function must be called for the PC version to initialise the winsock module. Several calls to this function (to initialise several socket lists) will not cause problems.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">LdSck</td><td>(OUT) Socket list </td></tr>
    <tr><td class="paramname">Tra</td><td>Trace level (0: no trace; -1: don't change current)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Isma ETXEBERRIA - 10/Sep/2000</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Alex RODRIGUEZ - 14/Mar/2006. Avoid compilation warnings.</li>
<li>Ismael SERRANO - 18/Sep/2006: Add mutex management</li>
<li>Ismael SERRANO - 18/Sep/2006: Add mutex management</li>
<li>Alex RODRIGUEZ - 14/Mar/2006. Avoid compilation warnings.</li>
<li>Basilio TAMAYO - 13/Sep/2012: size arguments in DYNajoutexCol must be of type size_t</li>
</ul>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="tcp__ip_8c.html#a88389d2744ff2791c637ffd52e174871" title="Clean up TCP module.">TCPend</a> </dd></dl>

</div>
</div>
<a class="anchor" id="aa87cceab305afbec0f2b52630cab53af"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TCPrecv </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Sck</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Siz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>Nbr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read a stream from a connected socket. </p>
<p>Read a stream from a connected socket.</p>
<ul>
<li>Note that this operation may block the caller if no information has been written in the socket. Use TCPselect to check this condition.</li>
</ul>
<ul>
<li>When the operation fails we presume there's been a disconnection, so that we must close the socket. However, this must be done by the user because we may still have information to treat.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Sck</td><td>Socket identifier. </td></tr>
    <tr><td class="paramname">Buf</td><td>Reserved memory to leave the stream </td></tr>
    <tr><td class="paramname">Siz</td><td>Size of the buffer </td></tr>
    <tr><td class="paramname">Nbr</td><td>(out) Number of bytes read. 0 if peer disconnected.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Isma ETXEBERRIA - 23/Aug/2000</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Ismael SERRANO - 18/Sep/2006: Add mutex management</li>
<li>Ismael SERRANO - 22/Apr/2008. Free mutex at ERRend</li>
<li>Aitziber BARRERO - 23/Apr/2008. Add ERRret;</li>
<li><p class="startli">Lorea NAVARRO - 11/Oct/2012: correct warnings generated by doxygen tool. example 1:</p>
<p class="startli">char Buffer [MY_BUFF_SIZE];</p>
<p class="startli">ERRchk (TCPrecv (Sck, MY_BUFF_SIZE, Buffer, &amp;Nbr));</p>
</li>
</ul>
<p>example 2:</p>
<p>char Buffer [MY_BUFF_SIZE]; ... ERRchk (TCPrecv (Sck, MY_BUFF_SIZE - AlreadyRead, &amp;Buffer [AlreadyRead], &amp;Nbr)); </p>

</div>
</div>
<a class="anchor" id="add9d639729ff7a52c5d7f70cc59eede5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TCPrecvAll </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdSck</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read a stream from connected sockets. </p>
<p>Read a stream from connected sockets</p>
<ul>
<li>Note that this operation may block the caller. See TCPrecv and TCPselect for more details.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">LdSck</td><td>Socket list</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Isma ETXEBERRIA - 10/Sep/2000</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Ismael SERRANO - 18/Sep/2006: Add mutex management</li>
</ul>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Ismael SERRANO - 18/Sep/2006: Add mutex management </li>
</ul>

</div>
</div>
<a class="anchor" id="ac23aadcf858b15037b23b3eafc00baf7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TCPselect </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdSck</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Tmo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>NbRdy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Select sockets ready for reading. </p>
<p>Select sockets ready for reading</p>
<ul>
<li>Take a list of sockets registered in a LdSck (see lcTCPregis for more details) and see if any of them is ready for reading. This operation will wait for a given timeout (time to wait).</li>
<li>A timeout of 0.0 will return immediately with the list of ready sockets (possibly none).</li>
<li>This implementation enables specifying a time granularity up to the microsecond (10^-6 seconds) but the accuracy of this value depends on the underlying operating system.</li>
<li>A negative timeout value will block indefinitely the caller until at least one of the sockets is ready.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">LdSck</td><td>Socket list </td></tr>
    <tr><td class="paramname">Tmo</td><td>(in/out) Timeout in seconds (e.g. 5.25). It returns an estimation of the time remaining to the timeout. For the current implementation the time granularity is one second. </td></tr>
    <tr><td class="paramname">NbRdy</td><td>(out) Number of ready sockets</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>Error code (0 if OK)</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Isma ETXEBERRIA - 10/Sep/2000</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Nerea RAMOS - 10/Apr/2002 Control if LdSck parameter is NULL</li>
<li>Ismael SERRANO - 18/Sep/2006: Add mutex management</li>
<li>Ismael SERRANO - 22/Apr/2008. Free mutex at ERRend</li>
<li>Ismael SERRANO - 18/Sep/2006: Add mutex management</li>
<li>Josune BIKUNA - 02/Mar/2010: Improve the managment of some traces. Convert some traces from level 2 to 3, and improve the message of others.</li>
<li>Egoitz GARAY - 06/Feb/2015: Disabled warning 4127 on Visual Studio. </li>
</ul>

</div>
</div>
<a class="anchor" id="af7b8dc469d47fc8e95c77e668d7584f7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TCPsend </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Sck</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Siz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>Nbw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write a stream into a connected socket. </p>
<p>Write a stream into a connected socket.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Sck</td><td>Socket identifier. </td></tr>
    <tr><td class="paramname">Msg</td><td>Stream to write </td></tr>
    <tr><td class="paramname">Siz</td><td>Number of bytes to write </td></tr>
    <tr><td class="paramname">Nbw</td><td>(out) Number of bytes to written</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Isma ETXEBERRIA - 23/Aug/2000</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Ismael SERRANO - 18/Sep/2006: Add mutex management</li>
<li>Ismael SERRANO - 22/Apr/2008. Free mutex at ERRend</li>
<li>Ismael SERRANO - 18/Sep/2006: Add mutex management</li>
<li>Josune BIKUNA - 16/Feb/2011: Use lcTCPgetLstErr for getting the error message. It is based on getting the errors in different ways depending on the operating system</li>
</ul>
<div class="fragment"><div class="line"><a class="code" href="err_def_8h.html#a4ba6b8261664a96881091edeef199a03">ERRchk</a> (<a class="code" href="tcp__def_8h.html#a259e550a580fd63e460c33ccfe379897" title="Write a stream into a connected socket.">TCPsend</a> (Sck, Message, NbMsg, &amp;Nbr));</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="a52485082bdaba827b25831aa4dd7eb79"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TCPstep </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Sck</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Stp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdSck</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Specify the data allocation step of a socket data. </p>
<p>Specify the data allocation step of a socket data. Not that this function doesn't reallocate data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Sck</td><td>Socket (TCP_ALL_SCK: all) </td></tr>
    <tr><td class="paramname">Stp</td><td>Step (default: 256) </td></tr>
    <tr><td class="paramname">LdSck</td><td>Socket list</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Isma ETXEBERRIA - 10/Sep/2000</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Ismael SERRANO - 18/Sep/2006: Add mutex management</li>
<li>Ismael SERRANO - 22/Apr/2008. Free mutex at ERRend</li>
</ul>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Ismael SERRANO - 18/Sep/2006: Add mutex management </li>
</ul>

</div>
</div>
<a class="anchor" id="ad3fcaaabd2bfcadf457a3ff1bb005fb0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TCPtrace </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Tra</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the trace level of the module. </p>
<p>Set the trace level of the module</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Tra</td><td>Trace level (0: no trace)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Isma ETXEBERRIA - 23/Aug/2000</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Ismael SERRANO - 18/Sep/2006: Add mutex management</li>
</ul>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Ismael SERRANO - 18/Sep/2006: Add mutex management </li>
</ul>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="ae5286b07b5d7869d2db33b1fa9e79a29"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int lcStep = 256</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a7aa38aa028456859096971cc7d699cc6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int lcTrace = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="tcp__ip_8c.html">tcp_ip.c</a></li>
    <li class="footer">Copyright &#169 ALMIS Informatica Financiera S.L. Reserved all the rights. Generated on Wed Jul 4 2018 22:30:41 for ALU by 
    <a href="http://www.almis.com">
    <img class="footer" src="DxyAlm.png" alt="ALMIS"/></a> </li>
  </ul>
</div>
</body>
</html>
