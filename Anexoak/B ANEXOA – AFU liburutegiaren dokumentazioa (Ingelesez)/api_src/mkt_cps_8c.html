<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>AFU: src/mktCps.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">AFU
   &#160;<span id="projectnumber">4.1</span>
   </div>
   <div id="projectbrief">ALMIS_Financial_utilities</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('mkt_cps_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">mktCps.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Calculation of solvency probability curve, CPS and temp to default simul matrix.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;alu_types.h&gt;</code><br/>
<code>#include &lt;cardinal.h&gt;</code><br/>
<code>#include &lt;carDef.h&gt;</code><br/>
<code>#include &lt;crsDef.h&gt;</code><br/>
<code>#include &lt;cst_def.h&gt;</code><br/>
<code>#include &lt;dynDef.h&gt;</code><br/>
<code>#include &lt;errDef.h&gt;</code><br/>
<code>#include &lt;gb.h&gt;</code><br/>
<code>#include &lt;itf_def.h&gt;</code><br/>
<code>#include &lt;memoire.h&gt;</code><br/>
<code>#include &lt;math_def.h&gt;</code><br/>
<code>#include &lt;obj_def.h&gt;</code><br/>
<code>#include &lt;tm_def.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="afu__def_8h_source.html">afu_def.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="afu_cfl_def_8h_source.html">afuCflDef.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="mkt__def_8h_source.html">mkt_def.h</a>&gt;</code><br/>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a6b0b74a6a2f4b292b7f9e8f5695c37e0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_cps_8c.html#a6b0b74a6a2f4b292b7f9e8f5695c37e0">MKT_CPS_TRT</a>&#160;&#160;&#160;7043</td></tr>
<tr class="separator:a6b0b74a6a2f4b292b7f9e8f5695c37e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2f83367e6bc355821053aa77a97266a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_cps_8c.html#ac2f83367e6bc355821053aa77a97266a">CALIBRATING_ERR</a>&#160;&#160;&#160;10 /* Error calibrating CPS: */</td></tr>
<tr class="separator:ac2f83367e6bc355821053aa77a97266a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30c17564229ec2e37dfea9c6c9ad643e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_cps_8c.html#a30c17564229ec2e37dfea9c6c9ad643e">TOLERANCE</a>&#160;&#160;&#160;0.000001</td></tr>
<tr class="separator:a30c17564229ec2e37dfea9c6c9ad643e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9cc087d076e4fa101f8794a947bd01a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_cps_8c.html#aa9cc087d076e4fa101f8794a947bd01a">ITERATIONS</a>&#160;&#160;&#160;200</td></tr>
<tr class="separator:aa9cc087d076e4fa101f8794a947bd01a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbe79b8f85a3c5ce957da838dcf9fa50"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_cps_8c.html#acbe79b8f85a3c5ce957da838dcf9fa50">BASE_ACT365</a>&#160;&#160;&#160;&quot;ACT/365&quot;</td></tr>
<tr class="separator:acbe79b8f85a3c5ce957da838dcf9fa50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dd77db54a6b1587ccffe62f3fa6da74"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_cps_8c.html#a1dd77db54a6b1587ccffe62f3fa6da74">BASE_ACTACT</a>&#160;&#160;&#160;&quot;ACT/ACT&quot;</td></tr>
<tr class="separator:a1dd77db54a6b1587ccffe62f3fa6da74"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa16d93cc9b1173c49df4eacb86a06ac6"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_cps_8c.html#aa16d93cc9b1173c49df4eacb86a06ac6">lcMKTcpsAndCpiCal</a> (int CpsTyp, char *CalDat, void **LdMkt)</td></tr>
<tr class="memdesc:aa16d93cc9b1173c49df4eacb86a06ac6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate CPS curves.  <a href="#aa16d93cc9b1173c49df4eacb86a06ac6"></a><br/></td></tr>
<tr class="separator:aa16d93cc9b1173c49df4eacb86a06ac6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d76c4db33807516da640c613da48bdc"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_cps_8c.html#a1d76c4db33807516da640c613da48bdc">lcMKTcpsCalBpv</a> (int CpsTyp, char *CalDat, void *LdMkt, void *LdCps, char *CdsCrv, int Pnt)</td></tr>
<tr class="memdesc:a1d76c4db33807516da640c613da48bdc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate BPV for one point of one CDS/CDSI curve.  <a href="#a1d76c4db33807516da640c613da48bdc"></a><br/></td></tr>
<tr class="separator:a1d76c4db33807516da640c613da48bdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa87db154bc755853573a08d7516cb1f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_cps_8c.html#aaa87db154bc755853573a08d7516cb1f">lcMKTcpsCalCdsErr</a> (int CpsTyp, double Lmb, char *CalDat, void *LdMkt, char *CdsCrv, int Pnt, void *LdCal, double *CdsErr)</td></tr>
<tr class="memdesc:aaa87db154bc755853573a08d7516cb1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the error when we value one point of CDS curve for a maturity date using a Cps curve list (adding Lmb to Cps list).  <a href="#aaa87db154bc755853573a08d7516cb1f"></a><br/></td></tr>
<tr class="separator:aaa87db154bc755853573a08d7516cb1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89ada0851a00c5c2e0b94abae50cc4c1"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_cps_8c.html#a89ada0851a00c5c2e0b94abae50cc4c1">lcMKTcpsLmbBisMth</a> (int CpsTyp, char *CalDat, void *LdMkt, char *CdsCrv, int Pnt)</td></tr>
<tr class="memdesc:a89ada0851a00c5c2e0b94abae50cc4c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate lambdas for CPS curve from CDS using bisection method.  <a href="#a89ada0851a00c5c2e0b94abae50cc4c1"></a><br/></td></tr>
<tr class="separator:a89ada0851a00c5c2e0b94abae50cc4c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee98de7691fe3433facd29a4e8e0d490"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_cps_8c.html#aee98de7691fe3433facd29a4e8e0d490">lcMKTcpsCdsValCalCpn</a> (void *LdMkt, void *LdCal, char *CalDat, char *ValDat, int IdxCal, double *Cpn)</td></tr>
<tr class="memdesc:aee98de7691fe3433facd29a4e8e0d490"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simulate a ficticiuos coupon. Only for CDS with variable reference.  <a href="#aee98de7691fe3433facd29a4e8e0d490"></a><br/></td></tr>
<tr class="separator:aee98de7691fe3433facd29a4e8e0d490"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e776a84f3273380636a13a5ab2dbd8a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_cps_8c.html#a3e776a84f3273380636a13a5ab2dbd8a">lcMKTcpsLmbPsoMth</a> (void *LdCps)</td></tr>
<tr class="memdesc:a3e776a84f3273380636a13a5ab2dbd8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate lambdas for CPS curve from CDS using bisection method.  <a href="#a3e776a84f3273380636a13a5ab2dbd8a"></a><br/></td></tr>
<tr class="separator:a3e776a84f3273380636a13a5ab2dbd8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66304227aa26c3bbb6c6ef9611a2560b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_cps_8c.html#a66304227aa26c3bbb6c6ef9611a2560b">MKTcpsCal</a> (char *CalDat, void **LdMkt)</td></tr>
<tr class="memdesc:a66304227aa26c3bbb6c6ef9611a2560b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate CPS curves.  <a href="#a66304227aa26c3bbb6c6ef9611a2560b"></a><br/></td></tr>
<tr class="separator:a66304227aa26c3bbb6c6ef9611a2560b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90e5e4a5675a787a73dd95ca9d09a3a8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_cps_8c.html#a90e5e4a5675a787a73dd95ca9d09a3a8">MKTcpiCal</a> (char *CalDat, void **LdMkt)</td></tr>
<tr class="memdesc:a90e5e4a5675a787a73dd95ca9d09a3a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate CPI curves.  <a href="#a90e5e4a5675a787a73dd95ca9d09a3a8"></a><br/></td></tr>
<tr class="separator:a90e5e4a5675a787a73dd95ca9d09a3a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70e8e0cf40622cfb20252ba3ab820ef9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_cps_8c.html#a70e8e0cf40622cfb20252ba3ab820ef9">MKTcpsCalCpsCds</a> (int CpsTyp, char *CalDat, void *LdMkt, char *CdsCrv)</td></tr>
<tr class="memdesc:a70e8e0cf40622cfb20252ba3ab820ef9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate CPS curve from one CDS curve using bisection method.  <a href="#a70e8e0cf40622cfb20252ba3ab820ef9"></a><br/></td></tr>
<tr class="separator:a70e8e0cf40622cfb20252ba3ab820ef9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2320f34d88f39f811d1da3f345765110"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_cps_8c.html#a2320f34d88f39f811d1da3f345765110">MKTcpsGetCoef</a> (int *Coef, double *Res)</td></tr>
<tr class="memdesc:a2320f34d88f39f811d1da3f345765110"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate coefficient like posible rate to do default in a period.  <a href="#a2320f34d88f39f811d1da3f345765110"></a><br/></td></tr>
<tr class="separator:a2320f34d88f39f811d1da3f345765110"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c16d4a31e1ec2b417bb6d177e475e6b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_cps_8c.html#a5c16d4a31e1ec2b417bb6d177e475e6b">MKTcpsCdsVal</a> (int CpsTyp, char *CalDat, char *ValDat, void *LdMkt, void *LdCal)</td></tr>
<tr class="memdesc:a5c16d4a31e1ec2b417bb6d177e475e6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">CDS value for a cds flow list using one Cps curve.  <a href="#a5c16d4a31e1ec2b417bb6d177e475e6b"></a><br/></td></tr>
<tr class="separator:a5c16d4a31e1ec2b417bb6d177e475e6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b374d8c26888cccb5d829619761b075"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_cps_8c.html#a5b374d8c26888cccb5d829619761b075">MKTcpsSprLmb</a> (double PrtVal, double DftVal, double Spr, double *SprLmb)</td></tr>
<tr class="memdesc:a5b374d8c26888cccb5d829619761b075"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the theoretical spread for the result of the valuation of flows.  <a href="#a5b374d8c26888cccb5d829619761b075"></a><br/></td></tr>
<tr class="separator:a5b374d8c26888cccb5d829619761b075"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cda64bfdb679755f0257e98ed9dace6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_cps_8c.html#a8cda64bfdb679755f0257e98ed9dace6">MKTcpsPrbCum</a> (int Pnt, void *LdCps)</td></tr>
<tr class="memdesc:a8cda64bfdb679755f0257e98ed9dace6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the cumulative (by prod) probability for a CPS curve point.  <a href="#a8cda64bfdb679755f0257e98ed9dace6"></a><br/></td></tr>
<tr class="separator:a8cda64bfdb679755f0257e98ed9dace6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10bab9fb014e7dd70f7561eeba958170"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_cps_8c.html#a10bab9fb014e7dd70f7561eeba958170">MKTcpsSolPro</a> (char *CalDat, char *PayDat, void *LdCps, double *SolPro)</td></tr>
<tr class="memdesc:a10bab9fb014e7dd70f7561eeba958170"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the solvency probability for a payment date.  <a href="#a10bab9fb014e7dd70f7561eeba958170"></a><br/></td></tr>
<tr class="separator:a10bab9fb014e7dd70f7561eeba958170"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d1df57024e0e1b3ef037cd7fa6b4054"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_cps_8c.html#a4d1df57024e0e1b3ef037cd7fa6b4054">MKTcpsSea</a> (void *LlCps, char *Crv, void **LdCrv)</td></tr>
<tr class="memdesc:a4d1df57024e0e1b3ef037cd7fa6b4054"><td class="mdescLeft">&#160;</td><td class="mdescRight">Search for a curve in a curve list, which may not be found.  <a href="#a4d1df57024e0e1b3ef037cd7fa6b4054"></a><br/></td></tr>
<tr class="separator:a4d1df57024e0e1b3ef037cd7fa6b4054"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8ffef9992186d0e27a382e2eba3151f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_cps_8c.html#af8ffef9992186d0e27a382e2eba3151f">MKTcpsGetInx</a> (void *LlCps, int Inx, void **LdCrv)</td></tr>
<tr class="memdesc:af8ffef9992186d0e27a382e2eba3151f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the CPS curve with given index.  <a href="#af8ffef9992186d0e27a382e2eba3151f"></a><br/></td></tr>
<tr class="separator:af8ffef9992186d0e27a382e2eba3151f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01a766a13fd12636ab9aca1fbef34297"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_cps_8c.html#a01a766a13fd12636ab9aca1fbef34297">MKTcpsGetInxCrv</a> (void *LlCps, int Inx, char **Crv)</td></tr>
<tr class="memdesc:a01a766a13fd12636ab9aca1fbef34297"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the date of a point in a CPS curve.  <a href="#a01a766a13fd12636ab9aca1fbef34297"></a><br/></td></tr>
<tr class="separator:a01a766a13fd12636ab9aca1fbef34297"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e8742ca7d2c452bd145dfa651675b24"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_cps_8c.html#a0e8742ca7d2c452bd145dfa651675b24">MKTcpsSimDflDat</a> (char *Bdt, char *Edt, char *ValDat, double Fct, char *NewBdt, char *DflDat, double *Acc)</td></tr>
<tr class="memdesc:a0e8742ca7d2c452bd145dfa651675b24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the simulated default date of a period.  <a href="#a0e8742ca7d2c452bd145dfa651675b24"></a><br/></td></tr>
<tr class="separator:a0e8742ca7d2c452bd145dfa651675b24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0db83e3e595dae590f3e34615eeea5b5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_cps_8c.html#a0db83e3e595dae590f3e34615eeea5b5">MKTcpsValDat</a> (char *Dev, char **DevPrv, char *CalDat, char *ValDat)</td></tr>
<tr class="memdesc:a0db83e3e595dae590f3e34615eeea5b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate a value date if there is a chage of currency.  <a href="#a0db83e3e595dae590f3e34615eeea5b5"></a><br/></td></tr>
<tr class="separator:a0db83e3e595dae590f3e34615eeea5b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f1129a2af2d3d4d6e6865e4bcfdb0c6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_cps_8c.html#a7f1129a2af2d3d4d6e6865e4bcfdb0c6">MKTcpsPsoTim</a> (char *CalDat, void *LdCps, double SolPro, double *PsoTim)</td></tr>
<tr class="memdesc:a7f1129a2af2d3d4d6e6865e4bcfdb0c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the time on year fraction for one given solvency probability and CPS curve.  <a href="#a7f1129a2af2d3d4d6e6865e4bcfdb0c6"></a><br/></td></tr>
<tr class="separator:a7f1129a2af2d3d4d6e6865e4bcfdb0c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0f5ebddad2da36ca1855219ac88163d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_cps_8c.html#af0f5ebddad2da36ca1855219ac88163d">MKTcpsSolProFwd</a> (void *LdCps, char *CalDat, char *Bdt, char *Edt, double *SolPro)</td></tr>
<tr class="memdesc:af0f5ebddad2da36ca1855219ac88163d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the solvency probability forward for a date.  <a href="#af0f5ebddad2da36ca1855219ac88163d"></a><br/></td></tr>
<tr class="separator:af0f5ebddad2da36ca1855219ac88163d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef7836f05f71f4c68dfd0ff3c3f5f72b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_cps_8c.html#aef7836f05f71f4c68dfd0ff3c3f5f72b">MKTcpsCalBpv</a> (void *LdSch, void *LdCps, void *LdYld, char *Dat, char *Bas, int BlmApx, double *Bpv)</td></tr>
<tr class="memdesc:aef7836f05f71f4c68dfd0ff3c3f5f72b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate BPV of CDS/CDSI option deals or CPS points.  <a href="#aef7836f05f71f4c68dfd0ff3c3f5f72b"></a><br/></td></tr>
<tr class="separator:aef7836f05f71f4c68dfd0ff3c3f5f72b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70baafb818e290cc0dd8fc6fe75d6f4c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_cps_8c.html#a70baafb818e290cc0dd8fc6fe75d6f4c">MKTcpsCalFrmPso</a> (char *CalDat, void *LdPso, void **LdMkt)</td></tr>
<tr class="memdesc:a70baafb818e290cc0dd8fc6fe75d6f4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate CPS curves from a list of solvency probability.  <a href="#a70baafb818e290cc0dd8fc6fe75d6f4c"></a><br/></td></tr>
<tr class="separator:a70baafb818e290cc0dd8fc6fe75d6f4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a793a7f61b73215b03fe70d172c08d929"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_cps_8c.html#a793a7f61b73215b03fe70d172c08d929">lcCpsColCod</a> = -1</td></tr>
<tr class="separator:a793a7f61b73215b03fe70d172c08d929"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f38a116bb90cb1a5adbf6e7aeef19e2"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_cps_8c.html#a5f38a116bb90cb1a5adbf6e7aeef19e2">lcCpsColLdCrv</a> = -1</td></tr>
<tr class="separator:a5f38a116bb90cb1a5adbf6e7aeef19e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Calculation of solvency probability curve, CPS and temp to default simul matrix. </p>
<dl class="section user"><dt>Header file</dt><dd><a class="el" href="mkt__def_8h.html" title="Header file for all MKT functions and types.">mkt_def.h</a></dd></dl>
<dl class="section user"><dt>Library</dt><dd>mkt</dd></dl>
<dl class="section user"><dt>Acronyme</dt><dd>MKTcps</dd></dl>
<p>Calculation of solvency probability curve, CPS. See <a class="el" href="mkt_8c.html" title="Market data general functions.">mkt.c</a> for details.</p>
<ul>
<li><p class="startli">- Must remeber that MKTcpsCal uses CDS, Yld and Rrt market data This means that correct order in calculations is MKTyldCal, MKTcdsCal, MKTrrtCal and MKTcpsCal</p>
<ul>
<li>For temp to default simulation matrix calcul see : MKTcpsCalMtxTdf</li>
</ul>
</li>
<li></li>
<li>- Data Structure.</li>
<li></li>
<li>- Object: Cps, list of CPS curves <hr/>
</li>
<li></li>
<li>Name Type Origin Description <hr/>
</li>
<li>cod CUR_TYPE crv_des.crv Curve name</li>
<li>dev DEV_TYPE crv_des.dev Currency</li>
<li>dat CDA_TYPE MKTcpsCal () Calculation date</li>
<li>LdCrv DYN_VOID MKTcpsCal or MKTcpsCalFrmPso List of points</li>
<li></li>
<li>LdCrv: Curve, list of points <hr/>
</li>
<li></li>
<li>Name Type Origin Description <hr/>
</li>
<li>bdt CDA_TYPE MKTcpsCalCpsCds () Init period date, maturity date from lower interval</li>
<li>edt CDA_TYPE MKTcpsCalCpsCds () Maturity date (Infinity in the last interval)</li>
<li>lmb DBL_TYPE MKTcpsCalCpsCds () Lambda</li>
<li>pso DBL_TYPE MKTcpsCalCpsCds () Probability of solvency at begin date</li>
<li><p class="startli">bpv DBL_TYPE MKTcpsCalCpsCds () BPV (risky factor o risky duration)</p>
<dl class="section author"><dt>Author</dt><dd>Manuel SANMARTIN - 26/Jan/2006 </dd></dl>
</li>
</ul>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="acbe79b8f85a3c5ce957da838dcf9fa50"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BASE_ACT365&#160;&#160;&#160;&quot;ACT/365&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a1dd77db54a6b1587ccffe62f3fa6da74"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BASE_ACTACT&#160;&#160;&#160;&quot;ACT/ACT&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ac2f83367e6bc355821053aa77a97266a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CALIBRATING_ERR&#160;&#160;&#160;10 /* Error calibrating CPS: */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aa9cc087d076e4fa101f8794a947bd01a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ITERATIONS&#160;&#160;&#160;200</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a6b0b74a6a2f4b292b7f9e8f5695c37e0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MKT_CPS_TRT&#160;&#160;&#160;7043</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a30c17564229ec2e37dfea9c6c9ad643e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TOLERANCE&#160;&#160;&#160;0.000001</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="aa16d93cc9b1173c49df4eacb86a06ac6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int lcMKTcpsAndCpiCal </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>CpsTyp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>CalDat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>LdMkt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate CPS curves. </p>
<p>Calculate CPS curves.</p>
<ul>
<li><p class="startli">This function is useful to calculate CPS curves from CDS and CDSI curves.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CpsTyp</td><td>Type of CPS. See type mkt_cps_typ for details </td></tr>
    <tr><td class="paramname">CalDat</td><td>Calculation date </td></tr>
    <tr><td class="paramname">LdMkt</td><td>(in/out) Market data object dynamic list</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Basilio TAMAYO - 06/Oct/2006</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Basilio TAMAYO - 06/Oct/2006: make it static</li>
<li>Ruben GIL - 6/Jun/2007: Add bpv column in CPS curves points list</li>
<li>Basilio TAMAYO - 19/Sep/2012: DYNaddColumns and DYNajoutexCol must have size with type size_t </li>
</ul>
</li>
</ul>

</div>
</div>
<a class="anchor" id="a1d76c4db33807516da640c613da48bdc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int lcMKTcpsCalBpv </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>CpsTyp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>CalDat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdMkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdCps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>CdsCrv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Pnt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate BPV for one point of one CDS/CDSI curve. </p>
<p>Calculate BPV for one point of one CDS/CDSI curve. Add bpv column in the list to save the value</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CpsTyp</td><td>Type of CPS. See type mkt_cps_typ for details </td></tr>
    <tr><td class="paramname">CalDat</td><td>Calculation Date. </td></tr>
    <tr><td class="paramname">LdMkt</td><td>Market data structure </td></tr>
    <tr><td class="paramname">LdCps</td><td>(in/out) Cps/Cpsi curve </td></tr>
    <tr><td class="paramname">CdsCrv</td><td>Cds/Cdsi curve name </td></tr>
    <tr><td class="paramname">Pnt</td><td>Point of cds/cps - cdsi/cpsi curve</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Ruben GIL - 28/May/2007</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Basilio TAMAYO - 02/Aug/2007: Use MKTcrvFind instead of MKTcdsFind</li>
<li>Jon BARRUTIA - 23/Oct/2007: MKTcpsCalBpv needs another argument </li>
</ul>

</div>
</div>
<a class="anchor" id="aaa87db154bc755853573a08d7516cb1f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int lcMKTcpsCalCdsErr </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>CpsTyp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Lmb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>CalDat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdMkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>CdsCrv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Pnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdCal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>CdsErr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the error when we value one point of CDS curve for a maturity date using a Cps curve list (adding Lmb to Cps list). </p>
<p>Calculate the error when we value one CDS for a maturity date using a Cps curve list (adding Lmb to Cps list).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CpsTyp</td><td>Type of CPS. See type mkt_cps_typ for details </td></tr>
    <tr><td class="paramname">Lmb</td><td>Lambda </td></tr>
    <tr><td class="paramname">CalDat</td><td>Calculation Date. </td></tr>
    <tr><td class="paramname">LdMkt</td><td>Market data structure </td></tr>
    <tr><td class="paramname">CdsCrv</td><td>CDS curve code, same than CPS curve and recovery rate </td></tr>
    <tr><td class="paramname">Pnt</td><td>Point of Cds curve. </td></tr>
    <tr><td class="paramname">LdCal</td><td>List of flows to value. </td></tr>
    <tr><td class="paramname">CdsErr</td><td>(out) CDS valoration error</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Manuel SANMARTIN - 26/Jan/2006.</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Basilio TAMAYO - 23/Feb/2006: Use LdMkt structure to encapsulate different market data</li>
<li>Basilio TAMAYO - 07/Mar/2006: Correct the read of begin date Bdt</li>
<li>Manuel SANMARTIN - 28/Mar/2006: Change ValDat by CalDat.</li>
<li>Ramon MARTINEZ - 26/May/2006: Maturity date is the Pdt of the Cds</li>
<li>Basilio TAMAYO - 06/Oct/2006: Adapt it for CPI curves. New paramter CpsTyp</li>
<li>Basilio TAMAYO - 10/Nov/2006: Begin date of CPI curves: Point 0, always begin date of CDI curve, rest of points, if calDat &gt; end date of previous point get the begin date of CDI curve.</li>
<li>Ramon MARTINEZ - 30/Mar/2007: Add ValDat to MKTcpsCdsVal</li>
<li>Basilio TAMAYO - 02/Aug/2007: Use MKTcrvFind instead of MKTcdsFind </li>
</ul>

</div>
</div>
<a class="anchor" id="aee98de7691fe3433facd29a4e8e0d490"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int lcMKTcpsCdsValCalCpn </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdMkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdCal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>CalDat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>ValDat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>IdxCal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Cpn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Simulate a ficticiuos coupon. Only for CDS with variable reference. </p>
<p>Simulate a ficticiuos coupon. Only for CDS with variable reference</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">LdMkt</td><td>(in/out). Schedule list </td></tr>
    <tr><td class="paramname">LdCal</td><td>Cps curve list </td></tr>
    <tr><td class="paramname">CalDat</td><td>Yld curve list </td></tr>
    <tr><td class="paramname">ValDat</td><td>Calculation date </td></tr>
    <tr><td class="paramname">IdxCal</td><td>Base </td></tr>
    <tr><td class="paramname">Cpn</td><td>(out) Simulated coupon. is rounded to the nearest integer</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Alex RODRIGUEZ - 22/Mar/2011:</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Basilio TAMAYO - 18/Sep/2017: Get the maturity and unit from LdCal </li>
</ul>

</div>
</div>
<a class="anchor" id="a89ada0851a00c5c2e0b94abae50cc4c1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int lcMKTcpsLmbBisMth </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>CpsTyp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>CalDat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdMkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>CdsCrv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Pnt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate lambdas for CPS curve from CDS using bisection method. </p>
<p>Calculate lambdas for CPS curve from CDS using bisection method.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CpsTyp</td><td>Type of CPS. See type mkt_cps_typ for details </td></tr>
    <tr><td class="paramname">CalDat</td><td>Calculation Date. </td></tr>
    <tr><td class="paramname">LdMkt</td><td>Market data structure </td></tr>
    <tr><td class="paramname">CdsCrv</td><td>Cds curve name </td></tr>
    <tr><td class="paramname">Pnt</td><td>Point of cds/cps curve.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Manuel SANMARTIN - 26/Jan/2006.</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Basilio TAMAYO - 23/Feb/2006: Use LdMkt structure to encapsulate different market data</li>
<li>Basilio TAMAYO - 07/Mar/2006: Set recovery rate in per unit; not percentage</li>
<li>Ramon MARTINEZ - 20/Mar/2006: Manage the error if excess the number ITERATIONS</li>
<li>Ramon MARTINEZ - 27/Mar/2006: TEST_MKT_CPS: traces to test</li>
<li>Manuel SANMARTIN - 28/Mar/2006: Change ValDat by CalDat.</li>
<li>Basilio TAMAYO - 06/Oct/2006: Adapt it for CPI curves. New paramter CpsTyp</li>
<li>Basilio TAMAYO - 02/Aug/2007: Use MKTcrvFind instead of MKTcdsFind </li>
</ul>

</div>
</div>
<a class="anchor" id="a3e776a84f3273380636a13a5ab2dbd8a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int lcMKTcpsLmbPsoMth </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdCps</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate lambdas for CPS curve from CDS using bisection method. </p>
<p>Calculate lambdas for CPS curve from a list of probability of solvency.</p>
<ul>
<li>Ps(1) = exp (-Lmb(1) * Nby(1)) where:</li>
<li>+ Ps(1): probability of solvency in first point</li>
<li>+ exp: e elevado a ...</li>
<li>+ Lmb(1): Lambda of first point</li>
<li>+ Nby(1): number of years between CalDat and first probability of solvency date</li>
<li></li>
<li>Psn = exp (-(Lmb(1)*Nby(1)) - (Lmb(2)*(Nby(2)-Nby(1))) - ... - (Lmb(n) * (Nby(n) - Nby (n-1))</li>
</ul>
<ul>
<li>Where</li>
<li>SUM (-Lmb(i) * (Nby(i) - Nby(i-1))) - LN (PS(n))</li>
<li>Lmb(n) = ------------------------------------------------&mdash;</li>
<li>(Nby(n) - Nby(n-1))</li>
</ul>
<ul>
<li><p class="startli">As can be seen, lambdas are calculated in order. To calculate Lmb(2), first Lmb(1) must be already calculated, for Lmb(3) it is necessary Lmb (2) and so on.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">LdCps</td><td>(in/out) CPS curve. It must have bdt, edt and pso. Will add lmb.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Basilio TAMAYO - 23/Feb/2006 </dd></dl>
</li>
</ul>

</div>
</div>
<a class="anchor" id="a90e5e4a5675a787a73dd95ca9d09a3a8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MKTcpiCal </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>CalDat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>LdMkt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate CPI curves. </p>
<p>Calculate CPI curves.</p>
<ul>
<li><p class="startli">CPI curves have not get and check functions. They are calculated from the CDSI curves. So, before calling this function the CDI and yield calcules must have been finished correctly</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CalDat</td><td>Calculation date </td></tr>
    <tr><td class="paramname">LdMkt</td><td>(in/out) Market data object dynamic list</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Basilio TAMAYO - 25/May/2006</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Basilio TAMAYO - 06/Oct/2006: Use a common function to calculate CPS and CPSI curves</li>
<li>Manuel SANMARTIN - 21/May/2008: Add time marks</li>
<li>Manuel SANMARTIN - 08/Aug/2008: Remove time marks </li>
</ul>
</li>
</ul>

</div>
</div>
<a class="anchor" id="a66304227aa26c3bbb6c6ef9611a2560b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MKTcpsCal </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>CalDat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>LdMkt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate CPS curves. </p>
<p>Calculate CPS curves.</p>
<ul>
<li><p class="startli">CPS curves have not get and check functions. They are calculated from the CDS curves. So, before calling this function the CDS, yield and "recovery rate" calcules must have been finished correctly</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CalDat</td><td>Calculation date </td></tr>
    <tr><td class="paramname">LdMkt</td><td>(in/out) Market data object dynamic list</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Basilio TAMAYO - 23/Feb/2006</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Manuel SANMARTIN - 28/Mar/2006: Change ValDat by CalDat.</li>
<li>Basilio TAMAYO - 06/Oct/2006: Use a common function for CPS and CPSI curves </li>
</ul>
</li>
</ul>

</div>
</div>
<a class="anchor" id="aef7836f05f71f4c68dfd0ff3c3f5f72b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MKTcpsCalBpv </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdSch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdCps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdYld</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Dat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Bas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>BlmApx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Bpv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate BPV of CDS/CDSI option deals or CPS points. </p>
<p>Calculate BPV of CDS/CDSI option deals or CPS points. It adds to the schedule list (LdSch) some columns with some results:</p>
<ul>
<li>Ryf: Risky factor forward (also called DV01fwd)</li>
<li>Dsf: Discount factor forward</li>
<li>Psf: Probability of solvency forward</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">LdSch</td><td>(in/out). Schedule list </td></tr>
    <tr><td class="paramname">LdCps</td><td>Cps curve list </td></tr>
    <tr><td class="paramname">LdYld</td><td>Yld curve list </td></tr>
    <tr><td class="paramname">Dat</td><td>Calculation date </td></tr>
    <tr><td class="paramname">Bas</td><td>Base </td></tr>
    <tr><td class="paramname">BlmApx</td><td>Bloomberg aproximation (1) or not (0). Bloomberg aproximation means that the basis is rounded to the nearest integer </td></tr>
    <tr><td class="paramname">Bpv</td><td>(out)Bpv</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Ruben GIL - 14/Jun/2007</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Ramon MARTINEZ - 10/Oct/2007: Only treat interest cashflows</li>
<li>Jon BARRUTIA - 19/Oct/2007: Basis calculation similar than Bloomberg depending on "BlmApx"</li>
<li>Jon BARRUTIA - 24/Oct/2007: Add some columns with some calculations </li>
</ul>

</div>
</div>
<a class="anchor" id="a70e8e0cf40622cfb20252ba3ab820ef9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MKTcpsCalCpsCds </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>CpsTyp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>CalDat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdMkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>CdsCrv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate CPS curve from one CDS curve using bisection method. </p>
<p>Calculate CPS curve from one CDS curve using bisection method. Calculate BPV for points of the curve</p>
<ul>
<li>CPS : Solvency Probability Curve.</li>
<li>We need a CDS curve from one issuer (reference), the value date and the zero-coupon curve.</li>
<li>For each CDS curve point we need to know the maturity date, the basis, the spread and payment period.</li>
<li>This function calculates the lambdas (CPS curve) values for one CDS curve.</li>
<li>The structure of the CPS curve can be found in the descrition of the file</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CpsTyp</td><td>Type of CPS. See type mkt_cps_typ for details </td></tr>
    <tr><td class="paramname">CalDat</td><td>Calculation Date. </td></tr>
    <tr><td class="paramname">LdMkt</td><td>Market data structure </td></tr>
    <tr><td class="paramname">CdsCrv</td><td>Cds curve code</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Manuel SANMARTIN - 20/Jul/2005.</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Basilio TAMAYO - 23/Feb/2006: Use LdMkt structure to encapsulate different market data</li>
<li>Manuel SANMARTIN - 28/Mar/2006: Change ValDat by CalDat.</li>
<li>Basilio TAMAYO - 06/Oct/2006: Adapt it for CPI curves. New parameter CpsTyp</li>
<li>Ruben GIL - 28/May/2007: Add BPV column in the points of CDS curve list</li>
<li>Basilio TAMAYO - 02/Aug/2007: Use MKTcrvFind instead of MKTcdsFind </li>
</ul>

</div>
</div>
<a class="anchor" id="a70baafb818e290cc0dd8fc6fe75d6f4c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MKTcpsCalFrmPso </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>CalDat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdPso</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>LdMkt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate CPS curves from a list of solvency probability. </p>
<p>Calculate CPS curves.</p>
<ul>
<li>This function is useful to calculate CPS curves from lists of solvency probability. The list of solvency probability must have the following columns:</li>
<li>+ Cie: Name of the counterparty the solvency is for. Will be the CPS curve code</li>
<li>+ Dat: Date</li>
<li><p class="startli">+ SvlPbl: Probability of solvency of counterparty Cie in date Dat, referred to CalDat. This values must be between 0.0 and 1.0</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CalDat</td><td>Calculation date </td></tr>
    <tr><td class="paramname">LdPso</td><td>List of probability of solvency </td></tr>
    <tr><td class="paramname">LdMkt</td><td>(in/out) Market data object dynamic list.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Basilio TAMAYO - 22/Apr/2015 </dd></dl>
</li>
</ul>

</div>
</div>
<a class="anchor" id="a5c16d4a31e1ec2b417bb6d177e475e6b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MKTcpsCdsVal </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>CpsTyp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>CalDat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>ValDat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdMkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdCal</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>CDS value for a cds flow list using one Cps curve. </p>
<p>CDS value for a cds flow list using one Cps curve. &ndash; LdCal : &ndash; bdt : Begin date &ndash; edt : End date &ndash; pdt : Payment date &ndash; crv : Yield curve name &ndash; crvCds/crvCdi: CDS curve code. Same code to get CPS curve and recovery rate &ndash; ide : Flow type (Interest, Fees, Default) &ndash; mrk : Flag to calculate flow &ndash; leg : Leg to calcul. See cps_leg_typ for details &ndash; ntl : Nominal &ndash; cpn : Coupon, interest calculated (spr * aph) &ndash; cpo : Potential for the coupon part &ndash; ppo : Potential for the principal part &ndash; cre : Realised for the coupon part &ndash; pre : Realised for the principal partLmb</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CpsTyp</td><td>Type of CPS. See type mkt_cps_typ for details </td></tr>
    <tr><td class="paramname">CalDat</td><td>Calculation date </td></tr>
    <tr><td class="paramname">ValDat</td><td>Value date: NULL calculations of the CPS curve. So, ValDat will be calculated inside this function with the currency of the curve ValDat revaluation of deals. ValDat should have been calculated with the account currency </td></tr>
    <tr><td class="paramname">LdMkt</td><td>Market data structure. </td></tr>
    <tr><td class="paramname">LdCal</td><td>(in/out) List of payment periods to value</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Manuel SANMARTIN - 26/Jan/2006.</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Basilio TAMAYO - 23/Feb/2006: Use structure LdMkt</li>
<li>Basilio TAMAYO - 07/Mar/2006: Set recovery rate in per unit; not percentage. If a flow is of leg "both", calculate it as default and protection flow.</li>
<li>Basilio TAMAYO - 15/Mar/2006: Get recovery rate from deal it it has its own.</li>
<li>Ramon MARTINEZ - 20/Mar/2006: Get the validity of the recovery rate is wrong</li>
<li>Basilio TAMAYO - 20/Mar/2006: Use MKTcpsSimDflDat to get the default date</li>
<li>Ramon MARTINEZ - 27/Mar/2006: TEST_MKT_CPS: traces to test</li>
<li>Manuel SANMARTIN - 28/Mar/2006: Change ValDat by CalDat.</li>
<li>Ramon MARTINEZ - 25/Apr/2006: move printf of the default leg and add print -&mdash;</li>
<li>Basilio TAMAYO - 06/Jun/2006: Fees flows, only discount</li>
<li>Ramon MARTINEZ - 19/Jun/2006: MKTcpsSimDflDat: add ValDat and modify NewBdt</li>
<li>Basilio TAMAYO - 06/Oct/2006: Adapt it for CPI curves. New paramter CpsTyp</li>
<li>Ramon MARTINEZ - 30/Mar/2007: ValDat management</li>
<li>Alex RODRIGUEZ - 22/Mar/2011: Manage call to lcMKTcpsCdsValCalCpn </li>
</ul>

</div>
</div>
<a class="anchor" id="a2320f34d88f39f811d1da3f345765110"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MKTcpsGetCoef </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>Coef</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Res</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate coefficient like posible rate to do default in a period. </p>
<p>Calculate coefficient like posible rate to do default in a period. (by the moment it will be in the middle of the period rate = 0.5)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Coef</td><td>(out) Coefficient int. </td></tr>
    <tr><td class="paramname">Res</td><td>(out) Result dbl 1 / coefficient.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Manuel SANMARTIN - 26/Jan/2006.</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Basilio TAMAYO - 16/Mar/2006: Make public </li>
</ul>

</div>
</div>
<a class="anchor" id="af8ffef9992186d0e27a382e2eba3151f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MKTcpsGetInx </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LlCps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Inx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>LdCrv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the CPS curve with given index. </p>
<p>Get the CPS curve with given index</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">LlCps</td><td>List of curves </td></tr>
    <tr><td class="paramname">Inx</td><td>Index </td></tr>
    <tr><td class="paramname">LdCrv</td><td>(out) Curve list pointer (do not destroy!!)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Basilio TAMAYO - 23/Mar/2006</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="mkt_cps_8c.html#a4d1df57024e0e1b3ef037cd7fa6b4054" title="Search for a curve in a curve list, which may not be found.">MKTcpsSea</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a01a766a13fd12636ab9aca1fbef34297"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MKTcpsGetInxCrv </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LlCps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Inx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>Crv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the date of a point in a CPS curve. </p>
<p>Get the date of a point in a CPS curve</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">LlCps</td><td>List of CPS curves </td></tr>
    <tr><td class="paramname">Inx</td><td>Index </td></tr>
    <tr><td class="paramname">Crv</td><td>(out) Curve code</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Basilio TAMAYO - 04/Apr/2006 </dd></dl>

</div>
</div>
<a class="anchor" id="a8cda64bfdb679755f0257e98ed9dace6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MKTcpsPrbCum </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Pnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdCps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the cumulative (by prod) probability for a CPS curve point. </p>
<p>Calculate the cumulative (by prod) probability for a CPS curve point.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Pnt</td><td>Cps curve point. </td></tr>
    <tr><td class="paramname">LdCps</td><td>(in / out) Cps curve values. (bdt, edt, lmb, pso)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Manuel SANMARTIN - 26/Jan/2006.</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Basilio TAMAYO - 23/Feb/2006: Chage type of parameter LdCps</li>
<li>Basilio TAMAYO - 10/Nov/2006: If end date is previous to begin date, solvency is one </li>
</ul>

</div>
</div>
<a class="anchor" id="a7f1129a2af2d3d4d6e6865e4bcfdb0c6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MKTcpsPsoTim </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>CalDat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdCps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>SolPro</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>PsoTim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the time on year fraction for one given solvency probability and CPS curve. </p>
<p>Calculate the time on year fraction for one given solvency probability and CPS curve.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CalDat</td><td>Calculation date </td></tr>
    <tr><td class="paramname">LdCps</td><td>CPS curve list </td></tr>
    <tr><td class="paramname">SolPro</td><td>Solvency probability </td></tr>
    <tr><td class="paramname">PsoTim</td><td>(OUT) Time on year fraction</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Manuel SANMARTIN - 14/Mar/2007.</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Manuel SANMARTIN - 23/Apr/2007: When SolPro is upper than 1.0 PsoTim = 0.0 </li>
</ul>

</div>
</div>
<a class="anchor" id="a4d1df57024e0e1b3ef037cd7fa6b4054"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MKTcpsSea </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LlCps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Crv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>LdCrv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Search for a curve in a curve list, which may not be found. </p>
<p>Search for a curve in a curve list, which may not be found.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">LlCps</td><td>List of curves </td></tr>
    <tr><td class="paramname">Crv</td><td>Curve name </td></tr>
    <tr><td class="paramname">LdCrv</td><td>(out) Curve list pointer (do not destroy!!) - NULL if not found</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Basilio TAMAYO - 24/Feb/2006</dd></dl>
<dl class="section see"><dt>See Also</dt><dd>MKTcpsInxFnd </dd></dl>

</div>
</div>
<a class="anchor" id="a0e8742ca7d2c452bd145dfa651675b24"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MKTcpsSimDflDat </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Bdt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Edt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>ValDat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Fct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>NewBdt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>DflDat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Acc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the simulated default date of a period. </p>
<p>Calculate the simulated default date of a period.</p>
<ul>
<li>The simulated default date is a date between the begin and end date of the period. It is calculated as a fraction of the period.</li>
<li>If the value date is after the begin date of the period, the period is considered as if it started in value date, because the probability of a default before the value date is 0.0.</li>
<li>Also calculate the portion of the accrued from the real begin date of the period until the simulated default date.</li>
<li><p class="startli">Note that the value date is considered to be always before end date, this check will be done previous to the calling of this function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Bdt</td><td>Begin date of the period </td></tr>
    <tr><td class="paramname">Edt</td><td>End date of the period </td></tr>
    <tr><td class="paramname">ValDat</td><td>Value date </td></tr>
    <tr><td class="paramname">Fct</td><td>Fraction of the period to put the default date in </td></tr>
    <tr><td class="paramname">NewBdt</td><td>(out) Begin date of the "new" period. Memory should be allocated </td></tr>
    <tr><td class="paramname">DflDat</td><td>(out) Medium date. Of type CDA_TYPE. </td></tr>
    <tr><td class="paramname">Acc</td><td>(out) Accrued fraction from the begin date of the period until the default date</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Basilio TAMAYO - 20/Mar/2006:</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Manuel SANMARTIN - 28/Mar/2006: Change ValDat by CalDat.</li>
<li>Basilio TAMAYO - 09/May/2006: If Bdt equals Edt, return an accrued of 0.0</li>
<li>Ramon MARTINEZ - 16/Jun/2006: Add parameter Dev and modify type of NewBdt &ndash; Ramon MARTINEZ - 19/Jun/2006: ValDat and modify NewBdt </li>
</ul>
</li>
</ul>

</div>
</div>
<a class="anchor" id="a10bab9fb014e7dd70f7561eeba958170"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MKTcpsSolPro </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>CalDat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>PayDat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdCps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>SolPro</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the solvency probability for a payment date. </p>
<p>Calculate the solvency probability for a payment date.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CalDat</td><td>Calculation Date. </td></tr>
    <tr><td class="paramname">PayDat</td><td>Payment date (end of period) </td></tr>
    <tr><td class="paramname">LdCps</td><td>Cps curve. (edt, bdt, lmb, pso) </td></tr>
    <tr><td class="paramname">SolPro</td><td>(out) Solvency probability value.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Manuel SANMARTIN - 26/Jan/2006.</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Manuel SANMARTIN - 28/Mar/2006: Change ValDat by CalDat.</li>
</ul>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="mkt_cps_8c.html#af0f5ebddad2da36ca1855219ac88163d" title="Calculate the solvency probability forward for a date.">MKTcpsSolProFwd</a> </dd></dl>

</div>
</div>
<a class="anchor" id="af0f5ebddad2da36ca1855219ac88163d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MKTcpsSolProFwd </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdCps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>CalDat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Bdt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Edt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>SolPro</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the solvency probability forward for a date. </p>
<p>Calculate the solvency probability forward for a date</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">LdCps</td><td>Cps curve </td></tr>
    <tr><td class="paramname">CalDat</td><td>Calculation date </td></tr>
    <tr><td class="paramname">Bdt</td><td>Begin date </td></tr>
    <tr><td class="paramname">Edt</td><td>End date </td></tr>
    <tr><td class="paramname">SolPro</td><td>(out) Forward solvency probability value</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Ruben GIL - 30/May/2007</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="mkt_cps_8c.html#a10bab9fb014e7dd70f7561eeba958170" title="Calculate the solvency probability for a payment date.">MKTcpsSolPro</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a5b374d8c26888cccb5d829619761b075"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MKTcpsSprLmb </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>PrtVal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>DftVal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Spr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>SprLmb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the theoretical spread for the result of the valuation of flows. </p>
<p>Calculate the theoretical spread for the result of the valuation of flows</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PrtVal</td><td>Value of the protection leg </td></tr>
    <tr><td class="paramname">DftVal</td><td>Value of the default leg </td></tr>
    <tr><td class="paramname">Spr</td><td>Initial spread </td></tr>
    <tr><td class="paramname">SprLmb</td><td>(out) Theoretical spread</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Basilio TAMAYO - 10/Apr/2006 </dd></dl>

</div>
</div>
<a class="anchor" id="a0db83e3e595dae590f3e34615eeea5b5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MKTcpsValDat </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>DevPrv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>CalDat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>ValDat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate a value date if there is a chage of currency. </p>
<p>Calculate a value date if there is a chage of currency, or the first time, i.e. DevPre is NULL</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Dev</td><td>Current currency (NOT NULL) </td></tr>
    <tr><td class="paramname">DevPrv</td><td>(IN/OUT) Previous currency. It can be NULL, for example the first time. If the value date is calculated, DevPrv will be modified, it will point to the same place than Dev </td></tr>
    <tr><td class="paramname">CalDat</td><td>Calculation date </td></tr>
    <tr><td class="paramname">ValDat</td><td>(OUT) Value date. Only calculated if necessary. The memory should be previously reserved</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Ramon MARTINEZ - 16/Jun/2006</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Ramon MARTINEZ - 06/Dec/2007: Use AFUdatCalValDatDev (before: next open date) </li>
</ul>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a793a7f61b73215b03fe70d172c08d929"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int lcCpsColCod = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a5f38a116bb90cb1a5adbf6e7aeef19e2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int lcCpsColLdCrv = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="mkt_cps_8c.html">mktCps.c</a></li>
    <li class="footer">Copyright &#169 ALMIS Informatica Financiera S.L. Reserved all the rights. Generated on Wed Jul 4 2018 22:33:49 for AFU by 
    <a href="http://www.almis.com">
    <img class="footer" src="DxyAlm.png" alt="ALMIS"/></a> </li>
  </ul>
</div>
</body>
</html>
