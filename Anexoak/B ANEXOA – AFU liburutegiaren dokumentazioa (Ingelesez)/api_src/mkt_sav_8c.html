<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>AFU: src/mktSav.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">AFU
   &#160;<span id="projectnumber">4.1</span>
   </div>
   <div id="projectbrief">ALMIS_Financial_utilities</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('mkt_sav_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">mktSav.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions to save data in mkt tables.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;cardinal.h&gt;</code><br/>
<code>#include &lt;alu_types.h&gt;</code><br/>
<code>#include &lt;cst_def.h&gt;</code><br/>
<code>#include &lt;db_def.h&gt;</code><br/>
<code>#include &lt;dynDef.h&gt;</code><br/>
<code>#include &lt;gb.h&gt;</code><br/>
<code>#include &lt;glbDef.h&gt;</code><br/>
<code>#include &lt;errDef.h&gt;</code><br/>
<code>#include &lt;fsa_def.h&gt;</code><br/>
<code>#include &lt;math_def.h&gt;</code><br/>
<code>#include &lt;mb_def.h&gt;</code><br/>
<code>#include &lt;obj_def.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="afu__types_8h_source.html">afu_types.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="mkt__def_8h_source.html">mkt_def.h</a>&gt;</code><br/>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a4ba1fdfe7e6d09f53fd2b736802e6069"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_sav_8c.html#a4ba1fdfe7e6d09f53fd2b736802e6069">MKT_SAV_TRT</a>&#160;&#160;&#160;7014</td></tr>
<tr class="separator:a4ba1fdfe7e6d09f53fd2b736802e6069"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab93ec7891d4fc671bafbc3185b9f6685"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_sav_8c.html#ab93ec7891d4fc671bafbc3185b9f6685">UNDEF_SAV_TYP</a>&#160;&#160;&#160;10</td></tr>
<tr class="separator:ab93ec7891d4fc671bafbc3185b9f6685"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15ac34afa16e7c0711c852d488fd3397"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_sav_8c.html#a15ac34afa16e7c0711c852d488fd3397">INF_ADD_MKT_ALS</a>&#160;&#160;&#160;20</td></tr>
<tr class="separator:a15ac34afa16e7c0711c852d488fd3397"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc34e745f71e6a4591572b0978f28d08"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_sav_8c.html#abc34e745f71e6a4591572b0978f28d08">INF_NEW_MKT</a>&#160;&#160;&#160;30</td></tr>
<tr class="separator:abc34e745f71e6a4591572b0978f28d08"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa5c7c4b1db99b2355af61e44112b6971"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_sav_8c.html#aa5c7c4b1db99b2355af61e44112b6971">lcMKTsavDta</a> (void *Ctx, char *Pro, char *CurAls, void *LdDta, void *LdIgn, int SavTyp, int MktCal, char *MktDat, char *AppDat, int MktDatTyp, int Rmv, void *LdAlsNdf, void *LdAlsTdb, void *LlPro, void *LlChlPro, void *LdUpd)</td></tr>
<tr class="memdesc:aa5c7c4b1db99b2355af61e44112b6971"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the mkt_dta on a base.  <a href="#aa5c7c4b1db99b2355af61e44112b6971"></a><br/></td></tr>
<tr class="separator:aa5c7c4b1db99b2355af61e44112b6971"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a537e872f24acf7f5bf20cd39602f4d38"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_sav_8c.html#a537e872f24acf7f5bf20cd39602f4d38">lcMKTsavCalSpc</a> (void *Ctx, char *Pro, char *Dat, void *LdDta, void **LdDtaSpc)</td></tr>
<tr class="memdesc:a537e872f24acf7f5bf20cd39602f4d38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate a list of spreads from the a bond price list.  <a href="#a537e872f24acf7f5bf20cd39602f4d38"></a><br/></td></tr>
<tr class="separator:a537e872f24acf7f5bf20cd39602f4d38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6be8e7fe0d556d19ec7febacfa9f430f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_sav_8c.html#a6be8e7fe0d556d19ec7febacfa9f430f">lcMKTsavGetPro</a> (void *Ctx, void *LdAlsNdf, void *LdAlsTdb, void **LlPro)</td></tr>
<tr class="memdesc:a6be8e7fe0d556d19ec7febacfa9f430f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get list of secondary profiles for all books, including the current one.  <a href="#a6be8e7fe0d556d19ec7febacfa9f430f"></a><br/></td></tr>
<tr class="separator:a6be8e7fe0d556d19ec7febacfa9f430f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac68d7908b3951b28909e811d33487d42"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_sav_8c.html#ac68d7908b3951b28909e811d33487d42">lcMKTsavTrtPnd</a> (void *Ctx, void *LdUpdPro, void *LdAls)</td></tr>
<tr class="memdesc:ac68d7908b3951b28909e811d33487d42"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a treatment as pending for a list of profiles and dates.  <a href="#ac68d7908b3951b28909e811d33487d42"></a><br/></td></tr>
<tr class="separator:ac68d7908b3951b28909e811d33487d42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ad151c398e844b7a4a9c6c0dadbab53"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_sav_8c.html#a3ad151c398e844b7a4a9c6c0dadbab53">lcMKTsavGetChlPro</a> (void *Ctx, void *LlPro, void **LlChlPro)</td></tr>
<tr class="memdesc:a3ad151c398e844b7a4a9c6c0dadbab53"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get lists of child profiles of all father profiles in all books.  <a href="#a3ad151c398e844b7a4a9c6c0dadbab53"></a><br/></td></tr>
<tr class="separator:a3ad151c398e844b7a4a9c6c0dadbab53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a526a15acef17a3d1940316cd594ee531"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_sav_8c.html#a526a15acef17a3d1940316cd594ee531">MKTsavDta</a> (void *Ctx, char *Pro, void *LdDta, int SavTyp, int MktCal, char *MktDat, int MktDatTyp, int Rmv, void *LdAlsNdf, void *LdAlsTdb)</td></tr>
<tr class="memdesc:a526a15acef17a3d1940316cd594ee531"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the mkt_dta on a base.  <a href="#a526a15acef17a3d1940316cd594ee531"></a><br/></td></tr>
<tr class="separator:a526a15acef17a3d1940316cd594ee531"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6393cdf9f52add458ae436d1e7fcd8d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_sav_8c.html#aa6393cdf9f52add458ae436d1e7fcd8d">MKTsavGetSta</a> (int SavTyp, int *Sta)</td></tr>
<tr class="memdesc:aa6393cdf9f52add458ae436d1e7fcd8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obtain the generl market data status depending on the saving type.  <a href="#aa6393cdf9f52add458ae436d1e7fcd8d"></a><br/></td></tr>
<tr class="separator:aa6393cdf9f52add458ae436d1e7fcd8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09faaa5431acc59501e04e4c29679c47"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_sav_8c.html#a09faaa5431acc59501e04e4c29679c47">MKTsavImc</a> (void *Ctx, char *Typ, void *LdDta)</td></tr>
<tr class="memdesc:a09faaa5431acc59501e04e4c29679c47"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the mkt_mcd table on a base.  <a href="#a09faaa5431acc59501e04e4c29679c47"></a><br/></td></tr>
<tr class="separator:a09faaa5431acc59501e04e4c29679c47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2db6c076b371d9fc45917e44a72b7b6c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_sav_8c.html#a2db6c076b371d9fc45917e44a72b7b6c">MKTsavOneDta</a> (void *Ctx, char *Imc, char *Pro, double Val, int ValSrc, int Idx, int Sta, char *Vdt, int *NbUpd)</td></tr>
<tr class="memdesc:a2db6c076b371d9fc45917e44a72b7b6c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update a market datum for an imc.  <a href="#a2db6c076b371d9fc45917e44a72b7b6c"></a><br/></td></tr>
<tr class="separator:a2db6c076b371d9fc45917e44a72b7b6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16265a28f110370fef44b232de28f100"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_sav_8c.html#a16265a28f110370fef44b232de28f100">MKTsavOneHisDta</a> (void *Ctx, char *Imc, char *Pro, char *Dat, double Val, int ValSrc, int Idx, int Sta, char *Vdt, int *NbUpd)</td></tr>
<tr class="memdesc:a16265a28f110370fef44b232de28f100"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update a historic market datum for an imc.  <a href="#a16265a28f110370fef44b232de28f100"></a><br/></td></tr>
<tr class="separator:a16265a28f110370fef44b232de28f100"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affb21cd6be7f530e8fd4e6c8d6127aa0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_sav_8c.html#affb21cd6be7f530e8fd4e6c8d6127aa0">MKTsavMis</a> (void *Ctx, char *Dat, void *LdDta, int His)</td></tr>
<tr class="memdesc:affb21cd6be7f530e8fd4e6c8d6127aa0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add missing market data in LdDta for all official profiles.  <a href="#affb21cd6be7f530e8fd4e6c8d6127aa0"></a><br/></td></tr>
<tr class="separator:affb21cd6be7f530e8fd4e6c8d6127aa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a097e5e1476c825cd4e775896a715334d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mkt_sav_8c.html#a097e5e1476c825cd4e775896a715334d">MKTsavNewPri</a> (void *Ctx, char *Dat, char *DatYst)</td></tr>
<tr class="memdesc:a097e5e1476c825cd4e775896a715334d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy the new price in the previous date.  <a href="#a097e5e1476c825cd4e775896a715334d"></a><br/></td></tr>
<tr class="separator:a097e5e1476c825cd4e775896a715334d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Functions to save data in mkt tables. </p>
<p>Functions to save data in mkt tables. To get descriptions about MKT group read the header of <a class="el" href="mkt_8c.html" title="Market data general functions.">mkt.c</a> file</p>
<dl class="section user"><dt>Header file</dt><dd><a class="el" href="mkt__def_8h.html" title="Header file for all MKT functions and types.">mkt_def.h</a></dd></dl>
<dl class="section user"><dt>Acronyme</dt><dd>MKTsav</dd></dl>
<dl class="section user"><dt>Library</dt><dd>mkt</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Edurne GORDOA - 18/Mar/2002 </dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a15ac34afa16e7c0711c852d488fd3397"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INF_ADD_MKT_ALS&#160;&#160;&#160;20</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="abc34e745f71e6a4591572b0978f28d08"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INF_NEW_MKT&#160;&#160;&#160;30</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a4ba1fdfe7e6d09f53fd2b736802e6069"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MKT_SAV_TRT&#160;&#160;&#160;7014</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ab93ec7891d4fc671bafbc3185b9f6685"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UNDEF_SAV_TYP&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a537e872f24acf7f5bf20cd39602f4d38"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int lcMKTsavCalSpc </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>Ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Pro</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Dat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdDta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>LdDtaSpc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate a list of spreads from the a bond price list. </p>
<p>Calculate a list of spreads from the a bond price list. If the list of prices passed as parameter does not correspond to a list of bond prices, do nothing and return an empty list, otherwise, returns a list similar to the passed one but with the imc and the val that correspond to spread values.</p>
<ul>
<li>Use the MKTcalSpc cst to carry out the treatment or not</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Ctx</td><td>Database context </td></tr>
    <tr><td class="paramname">Pro</td><td>Profile </td></tr>
    <tr><td class="paramname">Dat</td><td>Modification date </td></tr>
    <tr><td class="paramname">LdDta</td><td>List of data from which the spreads must be calculated </td></tr>
    <tr><td class="paramname">LdDtaSpc</td><td>(OUT) List of spread data to update</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Josune BIKUNA - 24/Nov/2003</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Josune BIKUNA - 28/Nov/2003. Control that this treatment must be only done when saving bond prices and not when saving spreads.</li>
<li>Josune BIKUNA - 16/Dec/2003. Sort the list of prices by contract to calculate the spread</li>
<li>Iker ZURIARRAIN - 14/Oct/2005. Add new parameter to MKTyldChk and MKTpriChk</li>
<li>Aitziber BARRERO - 01/Feb/2006: Add comment done in the last modification (AFUdatCurHis is used instead of datCurHis for IsCur)</li>
<li>Lorea NAVARRO - 23/Nov/2006: Add Ctx parameter in MKTpriCal function</li>
<li>Basilio TAMAYO - 25/Apr/2008: If it is a past date, get historic yield market data.</li>
<li>Josune BIKUNA - 23/Jul/2008: Besides taking into account if the contract is 'Private' to calculate the spread or not, the contract has a flag which defines if the contract is liable to spread calculation. Take also into account this flag (cb_vtr).</li>
<li>Josune BIKUNA - 28/Aug/2008: Use the field ctr.cc_swp instead of ctr.cb_vtr to chek if the spread must be calculated when the price is entered</li>
<li>Basilio TAMAYO - 06/Feb/2009: Read A.O. MKTcalSpc from database. </li>
</ul>

</div>
</div>
<a class="anchor" id="aa5c7c4b1db99b2355af61e44112b6971"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int lcMKTsavDta </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>Ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Pro</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>CurAls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdDta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdIgn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SavTyp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>MktCal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>MktDat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>AppDat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>MktDatTyp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Rmv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdAlsNdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdAlsTdb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LlPro</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LlChlPro</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdUpd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Update the mkt_dta on a base. </p>
<p>Update the mkt_dta on a base The explanation of types of value source can be found in MKTsavOneDta algorith: For each element in LdDta If value modified on purpose (column new)</p>
<ul>
<li>Save value and status of datum</li>
<li>If profile is main one copy value to rest of profiles If old value accepted</li>
<li>Modify status of datum If MktDat is not NULL historise the saved data</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Ctx</td><td>Database context </td></tr>
    <tr><td class="paramname">Pro</td><td>Profile </td></tr>
    <tr><td class="paramname">CurAls</td><td>Alias of current database. </td></tr>
    <tr><td class="paramname">LdDta</td><td>(in/out) List of data to update (imc, new, Idx, [val], [sta]) </td></tr>
    <tr><td class="paramname">LdIgn</td><td>(in/out) List of data not to modify (pro, imc) </td></tr>
    <tr><td class="paramname">SavTyp</td><td>Type of saving. See mkt_sav_typ in <a class="el" href="mkt__def_8h.html" title="Header file for all MKT functions and types.">mkt_def.h</a> </td></tr>
    <tr><td class="paramname">MktCal</td><td>Calculation methods. See enum mkt_cal. Only with SavTyp is MKT_SAV_CAL. </td></tr>
    <tr><td class="paramname">MktDat</td><td>Market data date </td></tr>
    <tr><td class="paramname">AppDat</td><td>Application date </td></tr>
    <tr><td class="paramname">Rmv</td><td>Flag to remove market datum that is not modified (1) or not (0) </td></tr>
    <tr><td class="paramname">MktDatTyp</td><td>Type of saving market data according to the date. See mkt_sav_dat_typ for details </td></tr>
    <tr><td class="paramname">LdAlsNdf</td><td>List of books with other books in diffusion </td></tr>
    <tr><td class="paramname">LdAlsTdb</td><td>List of terminal diffusion books </td></tr>
    <tr><td class="paramname">LlPro</td><td>List of main and secondary profiles. </td></tr>
    <tr><td class="paramname">LlChlPro</td><td>List of child profiles (als, pro, LdChlPro (pro)) </td></tr>
    <tr><td class="paramname">LdUpd</td><td>(in/out) List of profiles whose market data is updated (Pro, Dat). If it is NULL, do not manage this list.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0 if OK).</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Isma ETXEBERRIA - 04/May/1999</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Basilio TAMAYO - 21/Jan/2000 Rewrite function having in mind the current and new status of data. Join MKTsavDta and MKTsavDtaPro in a single function.</li>
<li>Basilio TAMAYO - 15/Aug/2000. Add parameter SavTyp and MktDat.</li>
<li>Edurne GORDOA - 23/Aug/2000. Use profiles type enumerated for pty</li>
<li>Basilio TAMAYO &amp; Mikel ARETXAGA - 19/Oct/2000.</li>
<li>Basilio TAMAYO - 16/Jan/2001. New management of SavTyp.</li>
<li>Basilio TAMAYO - 09/Jan/2002. Add crystallisation case</li>
<li>Edurne GORDOA - 18/Mar/2002. Carried from <a class="el" href="mkt_8c.html" title="Market data general functions.">mkt.c</a></li>
<li>Basilio TAMAYO - 01/Nov/2002. Add parameter LdAls</li>
<li>Alex RODRIGUEZ - 15/Oct/2003. Initialise Vble. 'ColPro' to avoid w2k lint warnings.</li>
<li>Gotzon ETXEBERRIA - 27/May/2004: Use ERRchk instead of ERRass when calling to DYNcbn[Chk]</li>
<li>Basilio TAMAYO - 06/Feb/2009: Divide books to diffuse between terminal and intermediary ones.</li>
<li>Josune BIKUNA - 29/May/2009: If the status of the new saved datum is 'mkt_sta_clean', when the rest of profiles inherit this value, although the status of the market data of the secondary profiles is 'mkt_sta_rtfile' or 'mkt_sta_rtcalc', they must inherit also the new value.</li>
<li>Basilio TAMAYO - 26/Nov/2009: Add parameter Rmv and MktDatTyp.</li>
<li>Basilio TAMAYO - 27/Nov/2009: Add parameter LlPro, CurAls and MktCal.</li>
<li>Basilio TAMAYO - 31/Dec/2009: Set status of secundary profiles as dirty if the status of of main profile is not clean.</li>
<li>Basilio TAMAYO - 15/Mar/2010: Copy of secondary profiles: do not overwrite "copied" values.</li>
<li>Basilio TAMAYO - 13/Jul/2010: Add parameter LdIgn; list of imc-pro that must not be updated because market data of previous date are not updated.</li>
<li>Basilio TAMAYO - 26/Jul/2010: Add the field Idx in LdDta</li>
<li>Basilio TAMAYO - 21/Oct/2010: Not need the column src in LdDta.</li>
<li>Basilio TAMAYO - 22/Oct/2010: New SavTyp MKT_SAV_DTY</li>
<li>Basilio TAMAYO - 01/Nov/2010: Add parameter LdUpd with the profiles whose market data is updated.</li>
<li>Basilio TAMAYO - 22/Sep/2011: If SavTyp is diffusion, only update dirty market data.</li>
<li>Basilio TAMAYO - 10/Nov/2011: Add parameter LlChlPro</li>
<li>Basilio TAMAYO - 03/Feb/2012: New field Vdt (Value date) in LdDta</li>
<li>Basilio TAMAYO - 15/Mar/2016: Treat new SavTyp MKT_SAV_CLO</li>
</ul>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="mkt_sav_8c.html#a2db6c076b371d9fc45917e44a72b7b6c" title="Update a market datum for an imc.">MKTsavOneDta</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a3ad151c398e844b7a4a9c6c0dadbab53"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int lcMKTsavGetChlPro </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>Ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LlPro</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>LlChlPro</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get lists of child profiles of all father profiles in all books. </p>
<p>Get lists of child profiles of all father profiles in all books.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Ctx</td><td>Database context </td></tr>
    <tr><td class="paramname">LlPro</td><td>List of books with other books in diffusion, as obtained in lcMKTsavGetPro </td></tr>
    <tr><td class="paramname">LlChlPro</td><td>(out) List of all child profiles of every profile in every book. Columns: als, pro, LdChlPro (pro). Free with DYNdetKnwLL ("LdChlPro", &amp;LlChlPro);</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0 if OK).</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Basilio TAMAYO - 27/Nov/2009</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Basilio TAMAYO - 19/Sep/2012: DYNaddColumns and DYNajoutexCol must have size with type size_t</li>
<li>Amparo CAMARERO - 05/Nov/2012: Modify function header to match new DOXYGEN format</li>
</ul>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="mkt_sav_8c.html#a6be8e7fe0d556d19ec7febacfa9f430f" title="Get list of secondary profiles for all books, including the current one.">lcMKTsavGetPro</a>. </dd></dl>

</div>
</div>
<a class="anchor" id="a6be8e7fe0d556d19ec7febacfa9f430f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int lcMKTsavGetPro </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>Ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdAlsNdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdAlsTdb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>LlPro</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get list of secondary profiles for all books, including the current one. </p>
<p>Get list of secondary profiles for all books, including the current one.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Ctx</td><td>Database context </td></tr>
    <tr><td class="paramname">LdAlsNdf</td><td>List of books with other books in diffusion </td></tr>
    <tr><td class="paramname">LdAlsTdb</td><td>List of terminal diffusion books </td></tr>
    <tr><td class="paramname">LlPro</td><td>(out) List of main profile and list of secondary profiles for every book: als, MaiPro, LdProSec (pro). Free with DYNdetKnwLL ("LdProSec", &amp;LlPro);</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0 if OK).</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Basilio TAMAYO - 27/Nov/2009</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="mkt_sav_8c.html#a3ad151c398e844b7a4a9c6c0dadbab53" title="Get lists of child profiles of all father profiles in all books.">lcMKTsavGetChlPro</a>. </dd></dl>

</div>
</div>
<a class="anchor" id="ac68d7908b3951b28909e811d33487d42"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int lcMKTsavTrtPnd </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>Ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdUpdPro</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdAls</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set a treatment as pending for a list of profiles and dates. </p>
<p>Set a treatment as pending for a list of profiles and dates.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Ctx</td><td>Database context </td></tr>
    <tr><td class="paramname">LdUpdPro</td><td>List of profiles and dates that have been modified; may be duplicated (Pro, Dat) </td></tr>
    <tr><td class="paramname">LdAls</td><td>List of diffusion books</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0 if OK).</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Basilio TAMAYO - 02/Nov/2010 </dd></dl>

</div>
</div>
<a class="anchor" id="a526a15acef17a3d1940316cd594ee531"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MKTsavDta </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>Ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Pro</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdDta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SavTyp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>MktCal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>MktDat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>MktDatTyp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Rmv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdAlsNdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdAlsTdb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the mkt_dta on a base. </p>
<p>Update the mkt_dta on a base The explanation of types of value source can be found in MKTsavOneDta algorith: For each element in LdDta If value modified on purpose (column new)</p>
<ul>
<li>Save value and status of datum</li>
<li>If profile is the main one copy value to rest of profiles If old value accepted</li>
<li>Modify status of datum If MktDat is not NULL historise the saved data If LdAlsNdf is NULL avoid to control if all books are in spected date If LdAlsTdb is NULL avoid to control if all books are in spected date</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Ctx</td><td>Database context </td></tr>
    <tr><td class="paramname">Pro</td><td>Profile </td></tr>
    <tr><td class="paramname">LdDta</td><td>List of data to update (imc, src, new, [val], [sta], Vdt) </td></tr>
    <tr><td class="paramname">SavTyp</td><td>Type of saving. See mkt_sav_typ in <a class="el" href="mkt__def_8h.html" title="Header file for all MKT functions and types.">mkt_def.h</a> </td></tr>
    <tr><td class="paramname">MktCal</td><td>Calculation methods. See enum mkt_cal. Only with SavTyp is MKT_SAV_CAL. </td></tr>
    <tr><td class="paramname">MktDat</td><td>Modification date </td></tr>
    <tr><td class="paramname">MktDatTyp</td><td>Type of data saving according to the date. See mkt_sav_dat_typ for details </td></tr>
    <tr><td class="paramname">Rmv</td><td>Flag to delete from the list the market data that is not modified. </td></tr>
    <tr><td class="paramname">LdAlsNdf</td><td>List of books with other books in diffusion </td></tr>
    <tr><td class="paramname">LdAlsTdb</td><td>List of terminal diffusion books</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0 if OK).</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Isma ETXEBERRIA - 04/May/1999</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Basilio TAMAYO - 21/Jan/2000 Rewrite function having in mind the current and new status of data. Join MKTsavDta and MKTsavDtaPro in a single function.</li>
<li>Basilio TAMAYO - 15/Aug/2000. Add parameter SavTyp and MktDat.</li>
<li>Edurne GORDOA - 23/Aug/2000. Use profiles type enumerated for pty</li>
<li>Basilio TAMAYO &amp; Mikel ARETXAGA - 19/Oct/2000.</li>
<li>Basilio TAMAYO - 16/Jan/2001. New management of SavTyp.</li>
<li>Basilio TAMAYO - 09/Jan/2002. Add crystallisation case</li>
<li>Edurne GORDOA - 18/Mar/2002. Carried from <a class="el" href="mkt_8c.html" title="Market data general functions.">mkt.c</a></li>
<li>Basilio TAMAYO - 01/Nov/2002. Add parameter LdAls</li>
<li>Alex RODRIGUEZ - 15/Oct/2003. Initialise Vble. 'ColPro' to avoid w2k lint warnings.</li>
<li>Josune BIKUNA - 24/Nov/2003. After saving the data passed as parameter,if the data corresponds to bond prices, try to calculate and save their associated bond spreads.</li>
<li>Basilio TAMAYO - 06/Feb/2009: Divide books to diffuse between terminal and intermediary ones.</li>
<li>Basilio TAMAYO - 10/Jun/2010: Define variable WekDay as CLINT</li>
<li>Basilio TAMAYO - 12/Jul/2010: Add a new list (LdIgn) with the list of imc-pro that must be ignored and not save in database.</li>
<li>Basilio TAMAYO - 21/Oct/2010: Nott need column src in LdDta.</li>
<li>Basilio TAMAYO - 22/Sep/2011: If SavTyp = MKT_SAV_SNG, diffuse in time but not copy to secondary profiles.</li>
<li>Basilio TAMAYO - 10/Nov/2011: Use child profiles in every book.</li>
<li>Basilio TAMAYO - 14/Dec/2011: Posibility to diffuse in weekends according to AO MktCloDat</li>
<li>Basilio TAMAYO - 19/Sep/2012: DYNaddColumns and DYNajoutexCol must have size with type size_t</li>
<li>Basilio TAMAYO - 15/Mar/2016: Treat new SavTyp MKT_SAV_CLO</li>
<li>Basilio TAMAYO - 05/May/2016: Treat new SavTyp MKT_SAV_CLO_SNG</li>
<li>Basilio TAMAYO - 21/Mar/2017: If there is a price duplicated, only treat one.</li>
<li>Nerea RAMOS - 28/Nov/2017: Get weekends days from get_cty_wek, because now some countries have Fridays (5) and Saturdays (6) as weekend days, instead of Saturdays (6) and Sundays (7). Get the account currency to determinate the country to obtaine weekend days</li>
</ul>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="mkt_sav_8c.html#a2db6c076b371d9fc45917e44a72b7b6c" title="Update a market datum for an imc.">MKTsavOneDta</a> </dd></dl>

</div>
</div>
<a class="anchor" id="aa6393cdf9f52add458ae436d1e7fcd8d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MKTsavGetSta </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SavTyp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>Sta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Obtain the generl market data status depending on the saving type. </p>
<p>Obtain the general market data status depending on the saving type</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">SavTyp</td><td>Type of saving. See mkt_sav_typ in <a class="el" href="mkt__def_8h.html" title="Header file for all MKT functions and types.">mkt_def.h</a> </td></tr>
    <tr><td class="paramname">Sta</td><td>(out) Status of the market data.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0 : OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Basilio TAMAYO - 30/Oct/2002</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Basilio TAMAYO - 17/Sep/2009: Add MKT_SAV_CPY.</li>
<li>Basilio TAMAYO - 22/Oct/2010: Add MKT_SAV_DTY</li>
<li>Basilio TAMAYO - 22/Sep/2011: Add MKT_SAV_DFF</li>
<li>Basilio TAMAYO - 15/Mar/2016: Add MKT_SAV_CLO</li>
<li>Basilio TAMAYO - 16/Mar/2016: Make it public</li>
<li>Basilio TAMAYO - 15/Mar/2016: Add MKT_SAV_CLO_SNG </li>
</ul>

</div>
</div>
<a class="anchor" id="a09faaa5431acc59501e04e4c29679c47"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MKTsavImc </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>Ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Typ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdDta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the mkt_mcd table on a base. </p>
<p>Update the mkt_mcd table on a base</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Ctx</td><td>Database context </td></tr>
    <tr><td class="paramname">Typ</td><td>Type of market data </td></tr>
    <tr><td class="paramname">LdDta</td><td>List of data to update (imc, new)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0 if OK).</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Isma ETXEBERRIA - 24/May/1999</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Edurne GORDOA - 18/Mar/2002. Carried from <a class="el" href="mkt_8c.html" title="Market data general functions.">mkt.c</a></li>
<li>Ruben GIL - 23/Aug/2012: Add call to MKTmcdHis function to historice market data codification </li>
</ul>

</div>
</div>
<a class="anchor" id="affb21cd6be7f530e8fd4e6c8d6127aa0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MKTsavMis </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>Ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Dat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>LdDta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>His</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add missing market data in LdDta for all official profiles. </p>
<p>Add missing market data in LdDta for all official profiles</p>
<ul>
<li>Get all official profiles</li>
<li>Get all profiles and market data in database from the list LdDta</li>
<li>For each profile and each market datum in LdDta, see if this couple exists.</li>
<li><p class="startli">If it doesn't exist, add it and set an info.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Ctx</td><td>Database conexion. </td></tr>
    <tr><td class="paramname">Dat</td><td>Application date. </td></tr>
    <tr><td class="paramname">LdDta</td><td>List of market data (cod, imc, val, Idx) </td></tr>
    <tr><td class="paramname">His</td><td>Flag to save also historic (1) or only current (0) market data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Basilio TAMAYO - 04/Mar/2005</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Basilio TAMAYO - 16/Mar/2005: Only add market prices in current book</li>
<li>Basilio TAMAYO - 02/Sep/2005: Audit price with 8 decimals</li>
<li>Jon BARRUTIA - 08/Sep/2005: mkt_dta_his modified only when mkt_dta is</li>
<li>Ruben GIL -09/Nov/2006: Add InfBok variable in CSTreadPasDB function</li>
<li>Basilio TAMAYO - 17/Sep/2009: Add new parameter NbUpd in MKTsavOneHisDta</li>
<li>Basilio TAMAYO - 26/Nov/2009: Add parameter to MKTsavOneDta</li>
<li>Basilio TAMAYO - 27/Jul/2010: New field Idx in LdDta</li>
<li>Basilio TAMAYO - 21/Oct/2010: diffuse historic market data from Dat until application date For this reason, use function MKTsavDta.</li>
<li>Basilio TAMAYO - 28/Oct/2010: Even if it is indicated as historic, if the market date is the application date check the existence of prices in current market data.</li>
<li>Basilio TAMAYO - 28/Oct/2010: Only save market data if it does not exist previously.</li>
<li>Basilio TAMAYO - 20/Jul/2012: Save market data also if there is a market data but it comes from a deal.</li>
<li>Basilio TAMAYO - 24/Aug/2012: Add market data dictionary in before saving market data not to have so many entries in dictionary table. </li>
</ul>
</li>
</ul>

</div>
</div>
<a class="anchor" id="a097e5e1476c825cd4e775896a715334d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MKTsavNewPri </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>Ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Dat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>DatYst</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copy the new price in the previous date. </p>
<p>Copy the new price in the previous date IMPORTANT: This function only execute after of the cristalization process</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Ctx</td><td>Database context </td></tr>
    <tr><td class="paramname">Dat</td><td>Date of generated the matrix </td></tr>
    <tr><td class="paramname">DatYst</td><td>Yesterday date</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0: OK)</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lorea NAVARRO - 09/Nov/2007</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Lorea NAVARRO - 12/Nov/2007: Correct the destroit list action after in the ERRend label.</li>
<li>Basilio TAMAYO - 17/Sep/2009: Add new parameter NbUpd in MKTsavOneHisDta</li>
<li>Basilio TAMAYO - 03/Feb/2012: Add new parameter Vdt in MKTsavOneHisDta </li>
</ul>

</div>
</div>
<a class="anchor" id="a2db6c076b371d9fc45917e44a72b7b6c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MKTsavOneDta </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>Ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Imc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Pro</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ValSrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Sta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Vdt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>NbUpd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update a market datum for an imc. </p>
<p>Update a market datum for an imc with a value and a status, depending on the status of the current datum and the source of value, it will carry on some actions or others.</p>
<ul>
<li>The different sources of data (ValSrc) are:</li>
<li>- MKT_VAL_NEW : User entered a new value for this profile.</li>
<li>- MKT_VAL_OLD : User accepted the old value for this profile without modifying it.</li>
<li>- MKT_VAL_INH : User entered a new value for another profile and pro inherits value in case of mkt_sta_dirty or mkt_sta_copied.</li>
<li>- MKT_VAL_INH_ALL: User entered a new value for another profile and pro inherits value in case of mkt_sta_dirty, mkt_sta_copied, mkt_sta_rtfile or mkt_sta_rtcalc.</li>
<li>- MKT_VAL_RTM : Real Time process modified this value for this profile.</li>
<li>Each of them manages the current data in a different way according to the current status of market datum.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Ctx</td><td>Database context </td></tr>
    <tr><td class="paramname">Imc</td><td>Imc of the datum to update </td></tr>
    <tr><td class="paramname">Pro</td><td>Profile </td></tr>
    <tr><td class="paramname">Val</td><td>Value to update </td></tr>
    <tr><td class="paramname">ValSrc</td><td>Source of the value-profile. See mkt_val_typ in <a class="el" href="mkt__def_8h.html" title="Header file for all MKT functions and types.">mkt_def.h</a> </td></tr>
    <tr><td class="paramname">Idx</td><td>Index of the market data dictionary </td></tr>
    <tr><td class="paramname">Sta</td><td>New status of market datum. See mkt_dta_status in <a class="el" href="mkt__def_8h.html" title="Header file for all MKT functions and types.">mkt_def.h</a> </td></tr>
    <tr><td class="paramname">Vdt</td><td>Value date (date the market datum is originally for). It may be NULL </td></tr>
    <tr><td class="paramname">NbUpd</td><td>Number of market data updated in database. It may be 0 or 1.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0 if OK).</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Basilio TAMAYO - 21/Jan/2000</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Basilio TAMAYO - 15/Sep/2000. Add parameter Src</li>
<li>Basilio TAMAYO &amp; Mikel ARETXAGA - 19/Oct/2000. Add default case</li>
<li>Basilio TAMAYO - 16/Jan/2001. Add parameter Sta</li>
<li>Basilio TAMAYO - 09/Jan/2002. Add new source (MKT_VAL_CRY) for crystallisation</li>
<li>Edurne GORDOA - 18/Mar/2002. Carried from <a class="el" href="mkt_8c.html" title="Market data general functions.">mkt.c</a></li>
<li>Basilio TAMAYO - 29/Oct/2002. Make it simplier and change where clauses to take advantage of the index on table.</li>
<li>Alex RODRIGUEZ - 31/May/2003. Add two decimals more to 'val' field. (6&ndash;&gt; 8).</li>
<li>Josune BIKUNA - 29/May/2009: When the market data value source is MKT_VAL_INH_ALL, the rest of profiles must be also inherit the value in case of mkt_sta_rtfile and mkt_sta_rtcalc</li>
<li>Basilio TAMAYO - 26/Nov/2009: Add parameter NbUpd.</li>
<li>Basilio TAMAYO - 14/Dec/2009: Update database if there is a change of value or status.</li>
<li>Basilio TAMAYO - 26/Jul/2010: Add the market data dictionary index Idx and delete Src.</li>
<li>Basilio TAMAYO - 03/Feb/2012: Add parameter Vdt (value date)</li>
<li>Basilio TAMAYO - 22/Feb/2012: Call GBdmdSelCnt with ERRchkGb instead of ERRchk</li>
<li>Basilio TAMAYO - 15/Mar/2016: If status of market dataum is mkt_sta_close, only update if the new status is also mkt_sta_close</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Modifications must be carried in parallel with MKTsavOneHisDta </dd></dl>

</div>
</div>
<a class="anchor" id="a16265a28f110370fef44b232de28f100"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MKTsavOneHisDta </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>Ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Imc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Pro</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Dat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ValSrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Sta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Vdt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>NbUpd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update a historic market datum for an imc. </p>
<p>Update a historic market datum for an imc, date and profile with a value and a status.</p>
<ul>
<li>Depending on the status of the current datum and the source of value, it will carry on some actions or others.</li>
<li>Each of them manages the current data in a different way according to the current status of market datum.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Ctx</td><td>Database context </td></tr>
    <tr><td class="paramname">Imc</td><td>Imc of the datum to update </td></tr>
    <tr><td class="paramname">Pro</td><td>Profile </td></tr>
    <tr><td class="paramname">Dat</td><td>Date </td></tr>
    <tr><td class="paramname">Val</td><td>Value to update </td></tr>
    <tr><td class="paramname">ValSrc</td><td>Source of the value-profile. See mkt_val_typ in <a class="el" href="mkt__def_8h.html" title="Header file for all MKT functions and types.">mkt_def.h</a> </td></tr>
    <tr><td class="paramname">Idx</td><td>Index of the market data dictionary </td></tr>
    <tr><td class="paramname">Sta</td><td>Status of datum </td></tr>
    <tr><td class="paramname">Vdt</td><td>Value date (date the market datum is originally for). It can be NULL </td></tr>
    <tr><td class="paramname">NbUpd</td><td>Number of market data updated in database. It may be 0 or 1.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code (0 if OK).</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Basilio TAMAYO - 16/Sep/2009</dd></dl>
<dl class="section user"><dt>Modified</dt><dd></dd></dl>
<ul>
<li>Basilio TAMAYO - 15/Sep/2000. Add parameter Src</li>
<li>Basilio TAMAYO &amp; Mikel ARETXAGA - 19/Oct/2000. Add default case</li>
<li>Basilio TAMAYO - 09/Jan/2002. Add new source (MKT_VAL_CRY) for crystallisation</li>
<li>Edurne GORDOA - 18/Mar/2002. Carried from <a class="el" href="mkt_8c.html" title="Market data general functions.">mkt.c</a></li>
<li>Basilio TAMAYO - 29/Oct/2002. Make it simplier and change where clauses to take advantage of the index on table</li>
<li>Alex RODRIGUEZ - 31/May/2003. Add two decimals more to 'val' field. (6&ndash;&gt; 8).</li>
<li>Basilio TAMAYO - 16/Sep/2009: Add parameter NbUpd.</li>
<li>Josune BIKUNA - 15/Oct/2009: When the market data value source is MKT_VAL_INH_ALL, the rest of profiles must be also inherit the value in case of mkt_sta_rtfile and mkt_sta_rtcalc</li>
<li>Basilio TAMAYO - 14/Dec/2009: Update database if there is a change of value or status.</li>
<li>Basilio TAMAYO - 26/Jul/2010: Add the market data dictionary index Idx and delete Src.</li>
<li>Basilio TAMAYO - 03/Feb/2012: Add parameter Vdt (value date)</li>
<li>Basilio TAMAYO - 22/Feb/2012: Call GBdmdSelCnt with ERRchkGb instead of ERRchk</li>
<li>Amparo CAMARERO - 05/Nov/2012: Modify function header to match new DOXYGEN format</li>
<li>Basilio TAMAYO - 15/Mar/2016: If status of market dataum is mkt_sta_close, only update if the new status is also mkt_sta_close</li>
</ul>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="mkt_sav_8c.html#a2db6c076b371d9fc45917e44a72b7b6c" title="Update a market datum for an imc.">MKTsavOneDta</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="mkt_sav_8c.html">mktSav.c</a></li>
    <li class="footer">Copyright &#169 ALMIS Informatica Financiera S.L. Reserved all the rights. Generated on Wed Jul 4 2018 22:33:50 for AFU by 
    <a href="http://www.almis.com">
    <img class="footer" src="DxyAlm.png" alt="ALMIS"/></a> </li>
  </ul>
</div>
</body>
</html>
